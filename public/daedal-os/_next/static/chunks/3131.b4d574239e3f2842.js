(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3131],{90170:function(t){var e;e=()=>(()=>{"use strict";var t,e,r={"./src/emfjs/Bitmap.ts":/*!*****************************!*\
  !*** ./src/emfjs/Bitmap.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{BitmapInfo:()=>n,DIBitmap:()=>l});var s=r(/*! ./Helper */"./src/emfjs/Helper.ts"),i=function(){function t(t,e){e&&t.skip(4),this.width=t.readUint16(),this.height=t.readUint16(),this.planes=t.readUint16(),this.bitcount=t.readUint16()}return t.prototype.colors=function(){return this.bitcount<=8?1<<this.bitcount:0},t}(),o=function(){function t(t,e){e&&t.skip(4),this.width=t.readInt32(),this.height=t.readInt32(),this.planes=t.readUint16(),this.bitcount=t.readUint16(),this.compression=t.readUint32(),this.sizeimage=t.readUint32(),this.xpelspermeter=t.readInt32(),this.ypelspermeter=t.readInt32(),this.clrused=t.readUint32(),this.clrimportant=t.readUint32()}return t.prototype.colors=function(){return 0!==this.clrused?this.clrused<256?this.clrused:256:this.bitcount>8?0:1<<this.bitcount},t}(),n=function(){function t(t,e){this._usergb=e;var r=t.readUint32();if(this._infosize=r,r===s.Helper.GDI.BITMAPCOREHEADER_SIZE)this._header=new i(t,!1),this._infosize+=this._header.colors()*(e?3:2);else{this._header=new o(t,!1);var n=this._header.compression===s.Helper.GDI.BitmapCompression.BI_BITFIELDS?3:0;r<=s.Helper.GDI.BITMAPINFOHEADER_SIZE+4*n&&(this._infosize=s.Helper.GDI.BITMAPINFOHEADER_SIZE+4*n),this._infosize+=this._header.colors()*(e?4:2)}}return t.prototype.getWidth=function(){return this._header.width},t.prototype.getHeight=function(){return Math.abs(this._header.height)},t.prototype.infosize=function(){return this._infosize},t.prototype.header=function(){return this._header},t}(),l=function(){function t(t,e){this._reader=t,this._offset=t.pos,this._location=e,this._info=new n(t,!0)}return t.prototype.getWidth=function(){return this._info.getWidth()},t.prototype.getHeight=function(){return this._info.getHeight()},t.prototype.totalSize=function(){return this._location.header.size+this._location.data.size},t.prototype.makeBitmapFileHeader=function(){var t=new Uint8Array(new ArrayBuffer(14));return t[0]=66,t[1]=77,s.Helper._writeUint32Val(t,2,this.totalSize()+14),s.Helper._writeUint32Val(t,10,this._info.infosize()+14),s.Helper._blobToBinary(t)},t.prototype.base64ref=function(){var t,e=this._reader.pos;this._reader.seek(this._offset);var r="image/bmp",i=this._info.header();if(i instanceof o&&null!=i.compression)switch(i.compression){case s.Helper.GDI.BitmapCompression.BI_JPEG:r="data:image/jpeg";break;case s.Helper.GDI.BitmapCompression.BI_PNG:r="data:image/png";break;default:t=this.makeBitmapFileHeader()}else t=this.makeBitmapFileHeader();this._reader.seek(this._location.header.offset),null!=t?t+=this._reader.readBinary(this._location.header.size):t=this._reader.readBinary(this._location.header.size),this._reader.seek(this._location.data.offset);var n="data:"+r+";base64,"+btoa(t+=this._reader.readBinary(this._location.data.size));return this._reader.seek(e),n},t}()},"./src/emfjs/Blob.ts":/*!***************************!*\
  !*** ./src/emfjs/Blob.ts ***!
  \***************************/(t,e,r)=>{r.r(e),r.d(e,{Blob:()=>i});var s=r(/*! ./Helper */"./src/emfjs/Helper.ts"),i=function(){function t(e,r){e instanceof t?(this.blob=e.blob,this.data=e.data,this.pos=r||e.pos):(this.blob=e,this.data=new Uint8Array(e),this.pos=r||0)}return t.prototype.eof=function(){return this.pos>=this.data.length},t.prototype.seek=function(t){if(t<0||t>this.data.length)throw new s.EMFJSError("Invalid seek position");this.pos=t},t.prototype.skip=function(t){var e=this.pos+t;if(e>this.data.length)throw new s.EMFJSError("Unexpected end of file");this.pos=e},t.prototype.readBinary=function(t){if(this.pos+t>this.data.length)throw new s.EMFJSError("Unexpected end of file");for(var e="";t-- >0;)e+=String.fromCharCode(this.data[this.pos++]);return e},t.prototype.readInt8=function(){if(this.pos+1>this.data.length)throw new s.EMFJSError("Unexpected end of file");return this.data[this.pos++]},t.prototype.readUint8=function(){return this.readInt8()>>>0},t.prototype.readInt32=function(){if(this.pos+4>this.data.length)throw new s.EMFJSError("Unexpected end of file");var t=this.data[this.pos++];return t|=this.data[this.pos++]<<8,t|=this.data[this.pos++]<<16,t|=this.data[this.pos++]<<24},t.prototype.readUint32=function(){return this.readInt32()>>>0},t.prototype.readUint16=function(){if(this.pos+2>this.data.length)throw new s.EMFJSError("Unexpected end of file");return this.data[this.pos++]|this.data[this.pos++]<<8},t.prototype.readInt16=function(){var t=this.readUint16();return t>32767&&(t-=65536),t},t.prototype.readString=function(t){if(this.pos+t>this.data.length)throw new s.EMFJSError("Unexpected end of file");for(var e="",r=0;r<t;r++)e+=String.fromCharCode(this.data[this.pos++]>>>0);return e},t.prototype.readNullTermString=function(t){var e="";if(t>0){t--;for(var r=0;r<t;r++){if(this.pos+r+1>this.data.length)throw new s.EMFJSError("Unexpected end of file");var i=this.data[this.pos+r]>>>0;if(0===i)break;e+=String.fromCharCode(i)}}return e},t.prototype.readFixedSizeUnicodeString=function(t){for(var e="",r=0;r<t;r++){var s=this.readUint16();if(0===s){++r<t&&this.skip((t-r)*2);break}e+=String.fromCharCode(s)}return e},t}()},"./src/emfjs/EMFRecords.ts":/*!*********************************!*\
  !*** ./src/emfjs/EMFRecords.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{EMFRecords:()=>a});var s=r(/*! ./Helper */"./src/emfjs/Helper.ts"),i=r(/*! ./Primitives */"./src/emfjs/Primitives.ts"),o=r(/*! ./Region */"./src/emfjs/Region.ts"),n=r(/*! ./Style */"./src/emfjs/Style.ts"),l=function(){function t(t,e){var r=t.pos-8;if(this.size=e,this.bounds=new i.RectL(t),this.frame=new i.RectL(t),t.readUint32()!==s.Helper.GDI.FormatSignature.ENHMETA_SIGNATURE)throw new s.EMFJSError("Invalid header signature");t.skip(4),t.skip(4),t.skip(4),t.skip(2),t.skip(2);var o=t.readUint32(),n=t.readUint32();this.nPalEntries=t.readUint32(),this.refDevCx=t.readUint32(),this.refDevCy=t.readUint32(),this.refDevCxMm=t.readUint32(),this.refDevCyMm=t.readUint32();var l=e;if(o>0){if(n<88)throw new s.EMFJSError("Invalid header description offset");if((l=n+2*o)>e)throw new s.EMFJSError("Invalid header description length");var a=t.pos;t.seek(r+n),this.description=t.readFixedSizeUnicodeString(o),t.seek(a)}else this.description="";if(l>=100){var h=t.readUint32(),p=t.readUint32();if(0!==t.readUint32())throw new s.EMFJSError("OpenGL records are not yet supported");if(0!==p){if(p<100||p<l)throw new s.EMFJSError("Invalid pixel format offset");if((l=p+h)>e)throw new s.EMFJSError("Invalid pixel format size")}l>=108&&(this.displayDevCxUm=t.readUint32(),this.displayDevCyUm=t.readUint32())}}return t.prototype.toString=function(){return"{bounds: "+this.bounds.toString()+", frame: "+this.frame.toString()+", description: "+this.description+"}"},t}(),a=function(){function t(t,e){this._records=[],this._header=new l(t,e);for(var r=!1,a=e,h=this;!r&&"break-main_loop"!==function(){t.seek(a);var e=t.readUint32(),l=t.readUint32();if(l<8)throw new s.EMFJSError("Invalid record size");switch(e){case s.Helper.GDI.RecordType.EMR_EOF:return r=!0,"break-main_loop";case s.Helper.GDI.RecordType.EMR_SETMAPMODE:var p=t.readInt32();h._records.push(function(t){t.setMapMode(p)});break;case s.Helper.GDI.RecordType.EMR_SETWINDOWORGEX:var c=t.readInt32(),u=t.readInt32();h._records.push(function(t){t.setWindowOrgEx(c,u)});break;case s.Helper.GDI.RecordType.EMR_SETWINDOWEXTEX:var d=t.readUint32(),E=t.readUint32();h._records.push(function(t){t.setWindowExtEx(d,E)});break;case s.Helper.GDI.RecordType.EMR_SETVIEWPORTORGEX:var f=t.readInt32(),T=t.readInt32();h._records.push(function(t){t.setViewportOrgEx(f,T)});break;case s.Helper.GDI.RecordType.EMR_SETVIEWPORTEXTEX:var g=t.readUint32(),_=t.readUint32();h._records.push(function(t){t.setViewportExtEx(g,_)});break;case s.Helper.GDI.RecordType.EMR_SAVEDC:h._records.push(function(t){t.saveDC()});break;case s.Helper.GDI.RecordType.EMR_RESTOREDC:var R=t.readInt32();h._records.push(function(t){t.restoreDC(R)});break;case s.Helper.GDI.RecordType.EMR_SETBKMODE:var S=t.readUint32();h._records.push(function(t){t.setBkMode(S)});break;case s.Helper.GDI.RecordType.EMR_SETBKCOLOR:var y=new n.ColorRef(t);h._records.push(function(t){t.setBkColor(y)});break;case s.Helper.GDI.RecordType.EMR_CREATEBRUSHINDIRECT:var I=t.readUint32(),v=new n.Brush(t);h._records.push(function(t){t.createBrush(I,v)});break;case s.Helper.GDI.RecordType.EMR_CREATEPEN:var b=t.readUint32(),A=new n.Pen(t,null);h._records.push(function(t){t.createPen(b,A)});break;case s.Helper.GDI.RecordType.EMR_EXTCREATEPEN:var w=t.readUint32(),M=t.readUint32(),O=t.readUint32(),P=t.readUint32(),D=t.readUint32(),H=new n.Pen(t,{header:{off:M,size:O},data:{off:P,size:D}});h._records.push(function(t){t.createPen(w,H)});break;case s.Helper.GDI.RecordType.EMR_SELECTOBJECT:var m=t.readUint32();h._records.push(function(t){t.selectObject(m,null)});break;case s.Helper.GDI.RecordType.EMR_DELETEOBJECT:var C=t.readUint32();h._records.push(function(t){t.deleteObject(C)});break;case s.Helper.GDI.RecordType.EMR_RECTANGLE:var L=new i.RectL(t);h._records.push(function(t){t.rectangle(L,0,0)});break;case s.Helper.GDI.RecordType.EMR_ROUNDRECT:var G=new i.RectL(t),N=new i.SizeL(t);h._records.push(function(t){t.rectangle(G,N.cx,N.cy)});break;case s.Helper.GDI.RecordType.EMR_LINETO:var x=t.readInt32(),B=t.readInt32();h._records.push(function(t){t.lineTo(x,B)});break;case s.Helper.GDI.RecordType.EMR_MOVETOEX:var U=t.readInt32(),k=t.readInt32();h._records.push(function(t){t.moveToEx(U,k)});break;case s.Helper.GDI.RecordType.EMR_POLYGON:case s.Helper.GDI.RecordType.EMR_POLYGON16:for(var F=e===s.Helper.GDI.RecordType.EMR_POLYGON16,j=new i.RectL(t),X=t.readUint32(),W=[];X>0;)W.push(F?new i.PointS(t):new i.PointL(t)),X--;h._records.push(function(t){t.polygon(W,j,!0)});break;case s.Helper.GDI.RecordType.EMR_POLYPOLYGON:case s.Helper.GDI.RecordType.EMR_POLYPOLYGON16:var F=e===s.Helper.GDI.RecordType.EMR_POLYPOLYGON16,Y=new i.RectL(t),V=t.readUint32();t.skip(4);for(var J=[],z=0;z<V;z++)J.push(t.readUint32());for(var Z=[],z=0;z<V;z++){for(var K=J[z],q=[],Q=0;Q<K;Q++)q.push(F?new i.PointS(t):new i.PointL(t));Z.push(q)}h._records.push(function(t){t.polyPolygon(Z,Y)});break;case s.Helper.GDI.RecordType.EMR_SETPOLYFILLMODE:var $=t.readUint32();h._records.push(function(t){t.setPolyFillMode($)});break;case s.Helper.GDI.RecordType.EMR_POLYLINE16:case s.Helper.GDI.RecordType.EMR_POLYLINETO16:for(var tt=e===s.Helper.GDI.RecordType.EMR_POLYLINETO16,te=new i.RectL(t),X=t.readUint32(),tr=[];X>0;)tr.push(new i.PointS(t)),X--;h._records.push(function(t){t.polyline(tt,tr,te)});break;case s.Helper.GDI.RecordType.EMR_POLYBEZIER:case s.Helper.GDI.RecordType.EMR_POLYBEZIERTO:for(var ts=e===s.Helper.GDI.RecordType.EMR_POLYBEZIERTO,ti=new i.RectL(t),X=t.readUint32(),to=[];X>0;)to.push(new i.PointL(t)),X--;h._records.push(function(t){t.polybezier(ts,to,ti)});break;case s.Helper.GDI.RecordType.EMR_POLYBEZIER16:for(var tn=new i.RectL(t),tl=new i.PointL(t),X=t.readUint32(),ta=[tl];X>0;)ta.push(new i.PointS(t)),X--;h._records.push(function(t){t.polybezier(!1,ta,tn)});break;case s.Helper.GDI.RecordType.EMR_POLYBEZIERTO16:for(var th=new i.RectL(t),X=t.readUint32(),tp=[];X>0;)tp.push(new i.PointS(t)),X--;h._records.push(function(t){t.polybezier(!0,tp,th)});break;case s.Helper.GDI.RecordType.EMR_SETTEXTALIGN:var tc=t.readUint32();h._records.push(function(t){t.setTextAlign(tc)});break;case s.Helper.GDI.RecordType.EMR_SETSTRETCHBLTMODE:var tu=t.readUint32();h._records.push(function(t){t.setStretchBltMode(tu)});break;case s.Helper.GDI.RecordType.EMR_SETBRUSHORGEX:var td=new i.PointL(t);h._records.push(function(t){t.setBrushOrgEx(td)});break;case s.Helper.GDI.RecordType.EMR_BEGINPATH:h._records.push(function(t){t.beginPath()});break;case s.Helper.GDI.RecordType.EMR_ENDPATH:h._records.push(function(t){t.endPath()});break;case s.Helper.GDI.RecordType.EMR_ABORTPATH:h._records.push(function(t){t.abortPath()});break;case s.Helper.GDI.RecordType.EMR_CLOSEFIGURE:h._records.push(function(t){t.closeFigure()});break;case s.Helper.GDI.RecordType.EMR_FILLPATH:var tE=new i.RectL(t);h._records.push(function(t){t.fillPath(tE)});break;case s.Helper.GDI.RecordType.EMR_STROKEPATH:var tf=new i.RectL(t);h._records.push(function(t){t.strokePath(tf)});break;case s.Helper.GDI.RecordType.EMR_SELECTCLIPPATH:var tT=t.readUint32();h._records.push(function(t){t.selectClipPath(tT)});break;case s.Helper.GDI.RecordType.EMR_EXTSELECTCLIPRGN:t.skip(4);var tg=t.readUint32(),t_=tg!==s.Helper.GDI.RegionMode.RGN_COPY?new o.Region(t):null;h._records.push(function(t){t.selectClipRgn(tg,t_)});break;case s.Helper.GDI.RecordType.EMR_OFFSETCLIPRGN:var tR=new i.PointL(t);h._records.push(function(t){t.offsetClipRgn(tR)});break;case s.Helper.GDI.RecordType.EMR_SETMITERLIMIT:var tS=t.readUint32();h._records.push(function(t){t.setMiterLimit(tS)});break;case s.Helper.GDI.RecordType.EMR_POLYLINE:case s.Helper.GDI.RecordType.EMR_POLYLINETO:case s.Helper.GDI.RecordType.EMR_POLYPOLYLINE:case s.Helper.GDI.RecordType.EMR_SETPIXELV:case s.Helper.GDI.RecordType.EMR_SETMAPPERFLAGS:case s.Helper.GDI.RecordType.EMR_SETROP2:case s.Helper.GDI.RecordType.EMR_SETCOLORADJUSTMENT:case s.Helper.GDI.RecordType.EMR_SETTEXTCOLOR:case s.Helper.GDI.RecordType.EMR_SETMETARGN:case s.Helper.GDI.RecordType.EMR_EXCLUDECLIPRECT:case s.Helper.GDI.RecordType.EMR_INTERSECTCLIPRECT:case s.Helper.GDI.RecordType.EMR_SCALEVIEWPORTEXTEX:case s.Helper.GDI.RecordType.EMR_SCALEWINDOWEXTEX:case s.Helper.GDI.RecordType.EMR_SETWORLDTRANSFORM:case s.Helper.GDI.RecordType.EMR_MODIFYWORLDTRANSFORM:case s.Helper.GDI.RecordType.EMR_ANGLEARC:case s.Helper.GDI.RecordType.EMR_ELLIPSE:case s.Helper.GDI.RecordType.EMR_ARC:case s.Helper.GDI.RecordType.EMR_CHORD:case s.Helper.GDI.RecordType.EMR_PIE:case s.Helper.GDI.RecordType.EMR_SELECTPALETTE:case s.Helper.GDI.RecordType.EMR_CREATEPALETTE:case s.Helper.GDI.RecordType.EMR_SETPALETTEENTRIES:case s.Helper.GDI.RecordType.EMR_RESIZEPALETTE:case s.Helper.GDI.RecordType.EMR_REALIZEPALETTE:case s.Helper.GDI.RecordType.EMR_EXTFLOODFILL:case s.Helper.GDI.RecordType.EMR_ARCTO:case s.Helper.GDI.RecordType.EMR_POLYDRAW:case s.Helper.GDI.RecordType.EMR_SETARCDIRECTION:case s.Helper.GDI.RecordType.EMR_STROKEANDFILLPATH:case s.Helper.GDI.RecordType.EMR_FLATTENPATH:case s.Helper.GDI.RecordType.EMR_WIDENPATH:case s.Helper.GDI.RecordType.EMR_COMMENT:case s.Helper.GDI.RecordType.EMR_FILLRGN:case s.Helper.GDI.RecordType.EMR_FRAMERGN:case s.Helper.GDI.RecordType.EMR_INVERTRGN:case s.Helper.GDI.RecordType.EMR_PAINTRGN:case s.Helper.GDI.RecordType.EMR_BITBLT:case s.Helper.GDI.RecordType.EMR_STRETCHBLT:case s.Helper.GDI.RecordType.EMR_MASKBLT:case s.Helper.GDI.RecordType.EMR_PLGBLT:case s.Helper.GDI.RecordType.EMR_SETDIBITSTODEVICE:case s.Helper.GDI.RecordType.EMR_STRETCHDIBITS:case s.Helper.GDI.RecordType.EMR_EXTCREATEFONTINDIRECTW:case s.Helper.GDI.RecordType.EMR_EXTTEXTOUTA:case s.Helper.GDI.RecordType.EMR_EXTTEXTOUTW:case s.Helper.GDI.RecordType.EMR_POLYPOLYLINE16:case s.Helper.GDI.RecordType.EMR_POLYDRAW16:case s.Helper.GDI.RecordType.EMR_CREATEMONOBRUSH:case s.Helper.GDI.RecordType.EMR_CREATEDIBPATTERNBRUSHPT:case s.Helper.GDI.RecordType.EMR_POLYTEXTOUTA:case s.Helper.GDI.RecordType.EMR_POLYTEXTOUTW:case s.Helper.GDI.RecordType.EMR_SETICMMODE:case s.Helper.GDI.RecordType.EMR_CREATECOLORSPACE:case s.Helper.GDI.RecordType.EMR_SETCOLORSPACE:case s.Helper.GDI.RecordType.EMR_DELETECOLORSPACE:case s.Helper.GDI.RecordType.EMR_GLSRECORD:case s.Helper.GDI.RecordType.EMR_GLSBOUNDEDRECORD:case s.Helper.GDI.RecordType.EMR_PIXELFORMAT:case s.Helper.GDI.RecordType.EMR_DRAWESCAPE:case s.Helper.GDI.RecordType.EMR_EXTESCAPE:case s.Helper.GDI.RecordType.EMR_SMALLTEXTOUT:case s.Helper.GDI.RecordType.EMR_FORCEUFIMAPPING:case s.Helper.GDI.RecordType.EMR_NAMEDESCAPE:case s.Helper.GDI.RecordType.EMR_COLORCORRECTPALETTE:case s.Helper.GDI.RecordType.EMR_SETICMPROFILEA:case s.Helper.GDI.RecordType.EMR_SETICMPROFILEW:case s.Helper.GDI.RecordType.EMR_ALPHABLEND:case s.Helper.GDI.RecordType.EMR_SETLAYOUT:case s.Helper.GDI.RecordType.EMR_TRANSPARENTBLT:case s.Helper.GDI.RecordType.EMR_GRADIENTFILL:case s.Helper.GDI.RecordType.EMR_SETLINKEDUFIS:case s.Helper.GDI.RecordType.EMR_SETTEXTJUSTIFICATION:case s.Helper.GDI.RecordType.EMR_COLORMATCHTOTARGETW:case s.Helper.GDI.RecordType.EMR_CREATECOLORSPACEW:default:var ty="UNKNOWN";for(var tI in s.Helper.GDI.RecordType)if(s.Helper.GDI.RecordType[tI]===e){ty=tI;break}s.Helper.log("[EMF] "+ty+" record (0x"+e.toString(16)+") at offset 0x"+a.toString(16)+" with "+l+" bytes")}a+=l}(););if(!r)throw new s.EMFJSError("Could not read all records")}return t.prototype.play=function(t){for(var e=this._records.length,r=0;r<e;r++)this._records[r](t)},t}()},"./src/emfjs/GDIContext.ts":/*!*********************************!*\
  !*** ./src/emfjs/GDIContext.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{GDIContext:()=>u});var s,i=r(/*! ./Helper */"./src/emfjs/Helper.ts"),o=r(/*! ./Primitives */"./src/emfjs/Primitives.ts"),n=r(/*! ./Region */"./src/emfjs/Region.ts"),l=r(/*! ./Style */"./src/emfjs/Style.ts"),a=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),h=function(t){function e(e,r){var s=t.call(this,"path")||this;return null!=e?s.svgPath=e:s.svgPath=r.svgPath,s}return a(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return"{[path]}"},e}(o.Obj),p=function(){var t=function(t,e,r){return new l.Brush(null,{style:i.Helper.GDI.BrushStyle.BS_SOLID,color:new l.ColorRef(null,t,e,r)})},e=function(t,e,r){return new l.Pen(null,i.Helper.GDI.PenStyle.PS_SOLID,1,new l.ColorRef(null,t,e,r),null)},r={WHITE_BRUSH:t(255,255,255),LTGRAY_BRUSH:t(212,208,200),GRAY_BRUSH:t(128,128,128),DKGRAY_BRUSH:t(64,64,64),BLACK_BRUSH:t(0,0,0),NULL_BRUSH:new l.Brush(null,{style:i.Helper.GDI.BrushStyle.BS_NULL}),WHITE_PEN:e(255,255,255),BLACK_PEN:e(0,0,0),NULL_PEN:new l.Pen(null,i.Helper.GDI.PenStyle.PS_NULL,0,null,null),OEM_FIXED_FONT:null,ANSI_FIXED_FONT:null,ANSI_VAR_FONT:null,SYSTEM_FONT:null,DEVICE_DEFAULT_FONT:null,DEFAULT_PALETTE:null,SYSTEM_FIXED_FONT:null,DEFAULT_GUI_FONT:null},s={};for(var o in r)s[(i.Helper.GDI.StockObject[o]-2147483648).toString()]=r[o];return s}(),c=function(t,e){if(null!=t)for(var r in this._svggroup=t._svggroup,this._svgclipChanged=t._svgclipChanged,this._svgtextbkfilter=t._svgtextbkfilter,this.mapmode=t.mapmode,this.stretchmode=t.stretchmode,this.textalign=t.textalign,this.bkmode=t.bkmode,this.textcolor=t.textcolor.clone(),this.bkcolor=t.bkcolor.clone(),this.polyfillmode=t.polyfillmode,this.miterlimit=t.miterlimit,this.wx=t.wx,this.wy=t.wy,this.ww=t.ww,this.wh=t.wh,this.vx=t.vx,this.vy=t.vy,this.vw=t.vw,this.vh=t.vh,this.x=t.x,this.y=t.y,this.nextbrx=t.nextbrx,this.nextbry=t.nextbry,this.brx=t.brx,this.bry=t.bry,this.clip=t.clip,this.ownclip=!1,this.selected={},t.selected)this.selected[r]=t.selected[r];else for(var r in this._svggroup=null,this._svgclipChanged=!1,this._svgtextbkfilter=null,this.mapmode=i.Helper.GDI.MapMode.MM_ANISOTROPIC,this.stretchmode=i.Helper.GDI.StretchMode.COLORONCOLOR,this.textalign=0,this.bkmode=i.Helper.GDI.MixMode.OPAQUE,this.textcolor=new l.ColorRef(null,0,0,0),this.bkcolor=new l.ColorRef(null,255,255,255),this.polyfillmode=i.Helper.GDI.PolygonFillMode.ALTERNATE,this.miterlimit=10,this.wx=0,this.wy=0,this.ww=0,this.wh=0,this.vx=0,this.vy=0,this.vw=0,this.vh=0,this.x=0,this.y=0,this.nextbrx=0,this.nextbry=0,this.brx=0,this.bry=0,this.clip=null,this.ownclip=!1,this.selected={},e){var s=e[r];this.selected[r]=null!=s?s.clone():null}},u=function(){function t(t){this._svg=t,this._svgdefs=null,this._svgPatterns={},this._svgClipPaths={},this._svgPath=null,this.defObjects={brush:new l.Brush(null,{style:i.Helper.GDI.BrushStyle.BS_SOLID,color:new l.ColorRef(null,0,0,0)}),pen:new l.Pen(null,i.Helper.GDI.PenStyle.PS_SOLID,1,new l.ColorRef(null,0,0,0),null),font:new l.Font(null,null),palette:null,region:null},this.state=new c(null,this.defObjects),this.statestack=[this.state],this.objects={}}return t.prototype.setMapMode=function(t){i.Helper.log("[gdi] setMapMode: mode="+t),this.state.mapmode=t,this.state._svggroup=null},t.prototype.setWindowOrgEx=function(t,e){i.Helper.log("[gdi] setWindowOrgEx: x="+t+" y="+e),this.state.wx=t,this.state.wy=e,this.state._svggroup=null},t.prototype.setWindowExtEx=function(t,e){i.Helper.log("[gdi] setWindowExtEx: x="+t+" y="+e),this.state.ww=t,this.state.wh=e,this.state._svggroup=null},t.prototype.setViewportOrgEx=function(t,e){i.Helper.log("[gdi] setViewportOrgEx: x="+t+" y="+e),this.state.vx=t,this.state.vy=e,this.state._svggroup=null},t.prototype.setViewportExtEx=function(t,e){i.Helper.log("[gdi] setViewportExtEx: x="+t+" y="+e),this.state.vw=t,this.state.vh=e,this.state._svggroup=null},t.prototype.setBrushOrgEx=function(t){i.Helper.log("[gdi] setBrushOrgEx: x="+t.x+" y="+t.y),this.state.nextbrx=t.x,this.state.nextbry=t.y},t.prototype.saveDC=function(){i.Helper.log("[gdi] saveDC");var t=this.state;this.state=new c(this.state),this.statestack.push(t),this.state._svggroup=null},t.prototype.restoreDC=function(t){if(i.Helper.log("[gdi] restoreDC: saved="+t),this.statestack.length>1){if(-1===t)this.state=this.statestack.pop();else if(t<-1)throw new i.EMFJSError("restoreDC: relative restore not implemented");else if(t>1)throw new i.EMFJSError("restoreDC: absolute restore not implemented")}else throw new i.EMFJSError("No saved contexts");this.state._svggroup=null},t.prototype.setStretchBltMode=function(t){i.Helper.log("[gdi] setStretchBltMode: stretchMode="+t)},t.prototype.rectangle=function(t,e,r){i.Helper.log("[gdi] rectangle: rect="+t.toString()+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());var s=this._todevY(t.bottom),o=this._todevX(t.right),n=this._todevY(t.top),l=this._todevX(t.left);e=this._todevH(e),r=this._todevH(r),i.Helper.log("[gdi] rectangle: TRANSLATED: bottom="+s+" right="+o+" top="+n+" left="+l+" rh="+r+" rw="+e),this._pushGroup();var a=this._applyOpts(null,!0,!0,!1);this._svg.rect(this.state._svggroup,l,n,o-l,s-n,e/2,r/2,a)},t.prototype.lineTo=function(t,e){i.Helper.log("[gdi] lineTo: x="+t+" y="+e+" with pen "+this.state.selected.pen.toString());var r=this._todevX(t),s=this._todevY(e),o=this._todevX(this.state.x),n=this._todevY(this.state.y);this.state.x=t,this.state.y=e,i.Helper.log("[gdi] lineTo: TRANSLATED: toX="+r+" toY="+s+" fromX="+o+" fromY="+n),this._pushGroup();var l=this._applyOpts(null,!0,!1,!1);this._svg.line(this.state._svggroup,o,n,r,s,l)},t.prototype.moveToEx=function(t,e){i.Helper.log("[gdi] moveToEx: x="+t+" y="+e),this.state.x=t,this.state.y=e,null!=this._svgPath&&(this._svgPath.move(this.state.x,this.state.y),i.Helper.log("[gdi] new path: "+this._svgPath.path()))},t.prototype.polygon=function(t,e,r){i.Helper.log("[gdi] polygon: points="+t+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());for(var s=[],o=0;o<t.length;o++){var n=t[o];s.push([this._todevX(n.x),this._todevY(n.y)])}r&&this._pushGroup();var l={"fill-rule":this.state.polyfillmode===i.Helper.GDI.PolygonFillMode.ALTERNATE?"evenodd":"nonzero"};this._applyOpts(l,!0,!0,!1),this._svg.polygon(this.state._svggroup,s,l)},t.prototype.polyPolygon=function(t,e){i.Helper.log("[gdi] polyPolygon: polygons.length="+t.length+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());for(var r=t.length,s=0;s<r;s++)this.polygon(t[s],e,0===s)},t.prototype.polyline=function(t,e,r){i.Helper.log("[gdi] polyline: isLineTo="+t.toString()+", points="+e+", bounds="+r.toString()+" with pen "+this.state.selected.pen.toString());for(var s=[],o=0;o<e.length;o++){var n=e[o];s.push([this._todevX(n.x),this._todevY(n.y)])}if(null!=this._svgPath){if(t&&0!==s.length){var l=s[0];this._svgPath.move(l[0],l[1])}else this._svgPath.move(this._todevX(this.state.x),this._todevY(this.state.y));this._svgPath.line(s),i.Helper.log("[gdi] new path: "+this._svgPath.path())}else{this._pushGroup();var a=this._applyOpts(null,!0,!1,!1);if(t&&e.length>0){var h=e[0];(h.x!==this.state.x||h.y!==this.state.y)&&s.unshift([this._todevX(this.state.x),this._todevY(this.state.y)])}this._svg.polyline(this.state._svggroup,s,a)}if(e.length>0){var p=e[e.length-1];this.state.x=p.x,this.state.y=p.y}},t.prototype.polybezier=function(t,e,r){i.Helper.log("[gdi] polybezier: isPolyBezierTo="+t.toString()+", points="+e+", bounds="+r.toString()+" with pen "+this.state.selected.pen.toString());for(var s=[],o=0;o<e.length;o++){var n=e[o];s.push({x:this._todevX(n.x),y:this._todevY(n.y)})}if(null!=this._svgPath){if(t&&s.length>0){var l=s[0];this._svgPath.move(l.x,l.y)}else this._svgPath.move(this._todevX(this.state.x),this._todevY(this.state.y));if(s.length<(t?3:4))throw new i.EMFJSError("Not enough points to draw bezier");for(var o=t?1:0;o+3<=s.length;o+=3){var a=s[o],h=s[o+1],p=s[o+2];this._svgPath.curveC(a.x,a.y,h.x,h.y,p.x,p.y)}i.Helper.log("[gdi] new path: "+this._svgPath.path())}else throw new i.EMFJSError("polybezier not implemented (not a path)");if(e.length>0){var c=e[e.length-1];this.state.x=c.x,this.state.y=c.y}},t.prototype.selectClipPath=function(t){i.Helper.log("[gdi] selectClipPath: rgnMode=0x"+t.toString(16))},t.prototype.selectClipRgn=function(t,e){if(i.Helper.log("[gdi] selectClipRgn: rgnMode=0x"+t.toString(16)),t===i.Helper.GDI.RegionMode.RGN_COPY)this.state.selected.region=e,this.state.clip=null,this.state.ownclip=!1;else{if(null==e)throw new i.EMFJSError("No clip region to select");throw new i.EMFJSError("Not implemented: rgnMode=0x"+t.toString(16))}this.state._svgclipChanged=!0},t.prototype.offsetClipRgn=function(t){i.Helper.log("[gdi] offsetClipRgn: offset="+t.toString()),this._getClipRgn().offset(t.x,t.y)},t.prototype.setTextAlign=function(t){i.Helper.log("[gdi] setTextAlign: textAlignmentMode=0x"+t.toString(16)),this.state.textalign=t},t.prototype.setMiterLimit=function(t){i.Helper.log("[gdi] setMiterLimit: miterLimit="+t),this.state.miterlimit=t},t.prototype.setBkMode=function(t){i.Helper.log("[gdi] setBkMode: bkMode=0x"+t.toString(16)),this.state.bkmode=t},t.prototype.setBkColor=function(t){i.Helper.log("[gdi] setBkColor: bkColor="+t.toString()),this.state.bkcolor=t,this.state._svgtextbkfilter=null},t.prototype.setPolyFillMode=function(t){i.Helper.log("[gdi] setPolyFillMode: polyFillMode="+t),this.state.polyfillmode=t},t.prototype.createBrush=function(t,e){var r=this._storeObject(e,t);i.Helper.log("[gdi] createBrush: brush="+e.toString()+" with handle "+r)},t.prototype.createPen=function(t,e){var r=this._storeObject(e,t);i.Helper.log("[gdi] createPen: pen="+e.toString()+" width handle "+r)},t.prototype.createPenEx=function(t,e){var r=this._storeObject(e,t);i.Helper.log("[gdi] createPenEx: pen="+e.toString()+" width handle "+r)},t.prototype.selectObject=function(t,e){var r=this._getObject(t);null!=r&&(null==e||r.type===e)?(this._selectObject(r),i.Helper.log("[gdi] selectObject: objIdx="+t+(r?" selected "+r.type+": "+r.toString():"[invalid index]"))):i.Helper.log("[gdi] selectObject: objIdx="+t+(r?" invalid object type: "+r.type:"[invalid index]"))},t.prototype.abortPath=function(){i.Helper.log("[gdi] abortPath"),null!=this._svgPath&&(this._svgPath=null)},t.prototype.beginPath=function(){i.Helper.log("[gdi] beginPath"),null!=this._svgPath&&(this._svgPath=null),this._svgPath=this._svg.createPath()},t.prototype.closeFigure=function(){if(i.Helper.log("[gdi] closeFigure"),null==this._svgPath)throw new i.EMFJSError("No path bracket: cannot close figure");this._svgPath.close()},t.prototype.fillPath=function(t){if(i.Helper.log("[gdi] fillPath"),null==this.state.selected.path)throw new i.EMFJSError("No path selected");var e=this.state.selected.path,r=this._applyOpts(null,!0,!0,!1);this._svg.path(this.state._svggroup,e.svgPath,r),this._pushGroup(),this.state.selected.path=null},t.prototype.strokePath=function(t){if(i.Helper.log("[gdi] strokePath"),null==this.state.selected.path)throw new i.EMFJSError("No path selected");var e=this.state.selected.path,r=this._applyOpts({fill:"none"},!0,!1,!1);this._svg.path(this.state._svggroup,e.svgPath,r),this._pushGroup(),this.state.selected.path=null},t.prototype.endPath=function(){if(i.Helper.log("[gdi] endPath"),null==this._svgPath)throw new i.EMFJSError("No path bracket: cannot end path");this._pushGroup(),this._selectObject(new h(this._svgPath)),this._svgPath=null},t.prototype.deleteObject=function(t){var e=this._deleteObject(t);i.Helper.log("[gdi] deleteObject: objIdx="+t+(e?" deleted object":"[invalid index]"))},t.prototype._pushGroup=function(){if(null==this.state._svggroup||this.state._svgclipChanged){this.state._svgclipChanged=!1,this.state._svgtextbkfilter=null;var t={viewBox:[this.state.vx,this.state.vy,this.state.vw,this.state.vh].join(" "),preserveAspectRatio:"none"};null!=this.state.clip?(i.Helper.log("[gdi] new svg x="+this.state.vx+" y="+this.state.vy+" width="+this.state.vw+" height="+this.state.vh+" with clipping"),t["clip-path"]="url(#"+this._getSvgClipPathForRegion(this.state.clip)+")"):i.Helper.log("[gdi] new svg x="+this.state.vx+" y="+this.state.vy+" width="+this.state.vw+" height="+this.state.vh+" without clipping"),this.state._svggroup=this._svg.svg(this.state._svggroup,this.state.vx,this.state.vy,this.state.vw,this.state.vh,t)}},t.prototype._getStockObject=function(t){return t>=2147483648&&t<=2147483665?p[(t-2147483648).toString()]:t===i.Helper.GDI.StockObject.DC_BRUSH?this.state.selected.brush:t===i.Helper.GDI.StockObject.DC_PEN?this.state.selected.pen:null},t.prototype._storeObject=function(t,e){if(!e){for(e=0;null!=this.objects[e.toString()]&&e<=65535;)e++;if(e>65535)return i.Helper.log("[gdi] Too many objects!"),-1}return this.objects[e.toString()]=t,e},t.prototype._getObject=function(t){var e=this.objects[t.toString()];return null==e&&null==(e=this._getStockObject(t))&&i.Helper.log("[gdi] No object with handle "+t),e},t.prototype._getSvgDef=function(){return null==this._svgdefs&&(this._svgdefs=this._svg.defs()),this._svgdefs},t.prototype._getSvgClipPathForRegion=function(t){for(var e in this._svgClipPaths)if(this._svgClipPaths[e]===t)return e;var r=i.Helper._makeUniqueId("c"),s=this._svg.clipPath(this._getSvgDef(),r,"userSpaceOnUse");switch(t.complexity){case 1:this._svg.rect(s,this._todevX(t.bounds.left),this._todevY(t.bounds.top),this._todevW(t.bounds.right-t.bounds.left),this._todevH(t.bounds.bottom-t.bounds.top),{fill:"black","stroke-width":0});break;case 2:for(var o=0;o<t.scans.length;o++)for(var n=t.scans[o],l=0;l<n.scanlines.length;l++){var a=n.scanlines[l];this._svg.rect(s,this._todevX(a.left),this._todevY(n.top),this._todevW(a.right-a.left),this._todevH(n.bottom-n.top),{fill:"black","stroke-width":0})}}return this._svgClipPaths[r]=t,r},t.prototype._getSvgPatternForBrush=function(t){for(var e in this._svgPatterns){var r,s,o;if(this._svgPatterns[e]===t)return e}switch(t.style){case i.Helper.GDI.BrushStyle.BS_PATTERN:r=t.pattern.getWidth(),s=t.pattern.getHeight();break;case i.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:r=t.dibpatternpt.getWidth(),s=t.dibpatternpt.getHeight(),o=t.dibpatternpt.base64ref();break;default:throw new i.EMFJSError("Invalid brush style")}var n=i.Helper._makeUniqueId("p"),l=this._svg.pattern(this._getSvgDef(),n,this.state.brx,this.state.bry,r,s,{patternUnits:"userSpaceOnUse"});return this._svg.image(l,0,0,r,s,o),this._svgPatterns[n]=t,n},t.prototype._selectObject=function(t){switch(this.state.selected[t.type]=t,t.type){case"region":this.state._svgclipChanged=!0;break;case"brush":this.state.brx=this.state.nextbrx,this.state.bry=this.state.nextbry}},t.prototype._deleteObject=function(t){var e=this.objects[t.toString()];if(null!=e){for(var r=0;r<this.statestack.length;r++){var s=this.statestack[r];s.selected[e.type]===e&&(s.selected[e.type]=this.defObjects[e.type].clone())}return delete this.objects[t.toString()],!0}return i.Helper.log("[gdi] Cannot delete object with invalid handle "+t),!1},t.prototype._getClipRgn=function(){return null!=this.state.clip?this.state.ownclip||(this.state.clip=this.state.clip.clone()):null!=this.state.selected.region?this.state.clip=this.state.selected.region.clone():this.state.clip=(0,n.CreateSimpleRegion)(this.state.wx,this.state.wy,this.state.wx+this.state.ww,this.state.wy+this.state.wh),this.state.ownclip=!0,this.state.clip},t.prototype._todevX=function(t){return Math.floor((t-this.state.wx)*(this.state.vw/this.state.ww))+this.state.vx},t.prototype._todevY=function(t){return Math.floor((t-this.state.wy)*(this.state.vh/this.state.wh))+this.state.vy},t.prototype._todevW=function(t){return Math.floor(this.state.vw/this.state.ww*t)+this.state.vx},t.prototype._todevH=function(t){return Math.floor(this.state.vh/this.state.wh*t)+this.state.vy},t.prototype._tologicalX=function(t){return Math.floor((t-this.state.vx)/(this.state.vw/this.state.ww))+this.state.wx},t.prototype._tologicalY=function(t){return Math.floor((t-this.state.vy)/(this.state.vh/this.state.wh))+this.state.wy},t.prototype._tologicalW=function(t){return Math.floor(t/(this.state.vw/this.state.ww))+this.state.wx},t.prototype._tologicalH=function(t){return Math.floor(t/(this.state.vh/this.state.wh))+this.state.wy},t.prototype._applyOpts=function(t,e,r,s){if(null==t&&(t={}),e){var o=this.state.selected.pen;if(o.style!==i.Helper.GDI.PenStyle.PS_NULL){t.stroke="#"+o.color.toHex(),t["stroke-width"]=o.width,t["stroke-miterlimit"]=this.state.miterlimit,t["stroke-linecap"]="round",t["stroke-linejoin"]="round";var n=4*t["stroke-width"],l=2*t["stroke-width"];switch(o.style){case i.Helper.GDI.PenStyle.PS_DASH:t["stroke-dasharray"]=[n,l].toString();break;case i.Helper.GDI.PenStyle.PS_DOT:t["stroke-dasharray"]=[1,l].toString();break;case i.Helper.GDI.PenStyle.PS_DASHDOT:t["stroke-dasharray"]=[n,l,1,l].toString();break;case i.Helper.GDI.PenStyle.PS_DASHDOTDOT:t["stroke-dasharray"]=[n,l,1,l,1,l].toString()}}}if(r){var a=this.state.selected.brush;switch(a.style){case i.Helper.GDI.BrushStyle.BS_SOLID:t.fill="#"+a.color.toHex();break;case i.Helper.GDI.BrushStyle.BS_PATTERN:case i.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:t.fill="url(#"+this._getSvgPatternForBrush(a)+")";break;case i.Helper.GDI.BrushStyle.BS_NULL:t.fill="none";break;default:i.Helper.log("[gdi] unsupported brush style: "+a.style),t.fill="none"}}if(s){var h=this.state.selected.font;t["font-family"]=h.facename,t["font-size"]=Math.abs(h.height),t.fill="#"+this.state.textcolor.toHex()}return t},t}()},"./src/emfjs/Helper.ts":/*!*****************************!*\
  !*** ./src/emfjs/Helper.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{EMFJSError:()=>o,Helper:()=>a,loggingEnabled:()=>l});var s,i=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=function(t){function e(e){var r=this.constructor,s=t.call(this,e)||this;return Object.setPrototypeOf(s,r.prototype),s}return i(e,t),e}(Error),n=!0;function l(t){n=t}var a=function(){function t(){}return t.log=function(t){n&&console.log(t)},t._makeUniqueId=function(t){return"EMFJS_"+t+this._uniqueId++},t._writeUint32Val=function(t,e,r){t[e++]=255&r,t[e++]=r>>>8&255,t[e++]=r>>>16&255,t[e++]=r>>>24&255},t._blobToBinary=function(t){for(var e="",r=t.length,s=0;s<r;s++)e+=String.fromCharCode(t[s]);return e},t.GDI={FormatSignature:{ENHMETA_SIGNATURE:1179469088,EPS_SIGNATURE:1179865157},BITMAPINFOHEADER_SIZE:40,BITMAPCOREHEADER_SIZE:12,RecordType:{EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122},MetafileEscapes:{NEWFRAME:1,ABORTDOC:2,NEXTBAND:3,SETCOLORTABLE:4,GETCOLORTABLE:5,FLUSHOUT:6,DRAFTMODE:7,QUERYESCSUPPORT:8,SETABORTPROC:9,STARTDOC:10,ENDDOC:11,GETPHYSPAGESIZE:12,GETPRINTINGOFFSET:13,GETSCALINGFACTOR:14,META_ESCAPE_ENHANCED_METAFILE:15,SETPENWIDTH:16,SETCOPYCOUNT:17,SETPAPERSOURCE:18,PASSTHROUGH:19,GETTECHNOLOGY:20,SETLINECAP:21,SETLINEJOIN:22,SETMITERLIMIT:23,BANDINFO:24,DRAWPATTERNRECT:25,GETVECTORPENSIZE:26,GETVECTORBRUSHSIZE:27,ENABLEDUPLEX:28,GETSETPAPERBINS:29,GETSETPRINTORIENT:30,ENUMPAPERBINS:31,SETDIBSCALING:32,EPSPRINTING:33,ENUMPAPERMETRICS:34,GETSETPAPERMETRICS:35,POSTSCRIPT_DATA:37,POSTSCRIPT_IGNORE:38,GETDEVICEUNITS:42,GETEXTENDEDTEXTMETRICS:256,GETPAIRKERNTABLE:258,EXTTEXTOUT:512,GETFACENAME:513,DOWNLOADFACE:514,METAFILE_DRIVER:2049,QUERYDIBSUPPORT:3073,BEGIN_PATH:4096,CLIP_TO_PATH:4097,END_PATH:4098,OPEN_CHANNEL:4110,DOWNLOADHEADER:4111,CLOSE_CHANNEL:4112,POSTSCRIPT_PASSTHROUGH:4115,ENCAPSULATED_POSTSCRIPT:4116,POSTSCRIPT_IDENTIFY:4117,POSTSCRIPT_INJECTION:4118,CHECKJPEGFORMAT:4119,CHECKPNGFORMAT:4120,GET_PS_FEATURESETTING:4121,MXDC_ESCAPE:4122,SPCLPASSTHROUGH2:4568},MapMode:{MM_TEXT:1,MM_LOMETRIC:2,MM_HIMETRIC:3,MM_LOENGLISH:4,MM_HIENGLISH:5,MM_TWIPS:6,MM_ISOTROPIC:7,MM_ANISOTROPIC:8},StretchMode:{BLACKONWHITE:1,WHITEONBLACK:2,COLORONCOLOR:3,HALFTONE:4},MixMode:{TRANSPARENT:1,OPAQUE:2},BrushStyle:{BS_SOLID:0,BS_NULL:1,BS_HATCHED:2,BS_PATTERN:3,BS_INDEXED:4,BS_DIBPATTERN:5,BS_DIBPATTERNPT:6,BS_PATTERN8X8:7,BS_DIBPATTERN8X8:8,BS_MONOPATTERN:9},PenStyle:{PS_COSMETIC:0,PS_ENDCAP_ROUND:0,PS_JOIN_ROUND:0,PS_SOLID:0,PS_DASH:1,PS_DOT:2,PS_DASHDOT:3,PS_DASHDOTDOT:4,PS_NULL:5,PS_INSIDEFRAME:6,PS_USERSTYLE:7,PS_ALTERNATE:8,PS_ENDCAP_SQUARE:256,PS_ENDCAP_FLAT:512,PS_JOIN_BEVEL:4096,PS_JOIN_MITER:8192,PS_GEOMETRIC:65536},PolygonFillMode:{ALTERNATE:1,WINDING:2},BitmapCompression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5},RegionMode:{RGN_AND:1,RGN_OR:2,RGN_XOR:3,RGN_DIFF:4,RGN_COPY:5},StockObject:{WHITE_BRUSH:2147483648,LTGRAY_BRUSH:2147483649,GRAY_BRUSH:2147483650,DKGRAY_BRUSH:2147483651,BLACK_BRUSH:2147483652,NULL_BRUSH:2147483653,WHITE_PEN:2147483654,BLACK_PEN:2147483655,NULL_PEN:2147483656,OEM_FIXED_FONT:2147483658,ANSI_FIXED_FONT:2147483659,ANSI_VAR_FONT:2147483660,SYSTEM_FONT:2147483661,DEVICE_DEFAULT_FONT:2147483662,DEFAULT_PALETTE:2147483663,SYSTEM_FIXED_FONT:2147483664,DEFAULT_GUI_FONT:2147483665,DC_BRUSH:2147483666,DC_PEN:2147483667}},t._uniqueId=0,t}()},"./src/emfjs/Primitives.ts":/*!*********************************!*\
  !*** ./src/emfjs/Primitives.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{Obj:()=>a,PointL:()=>o,PointS:()=>i,RectL:()=>n,SizeL:()=>l});var s=r(/*! ./Helper */"./src/emfjs/Helper.ts"),i=function(){function t(t,e,r){null!=t?(this.x=t.readInt16(),this.y=t.readInt16()):(this.x=e,this.y=r)}return t.prototype.clone=function(){return new t(null,this.x,this.y)},t.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+"}"},t}(),o=function(){function t(t,e,r){null!=t?(this.x=t.readInt32(),this.y=t.readInt32()):(this.x=e,this.y=r)}return t.prototype.clone=function(){return new t(null,this.x,this.y)},t.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+"}"},t}(),n=function(){function t(t,e,r,s,i){null!=t?(this.left=t.readInt32(),this.top=t.readInt32(),this.right=t.readInt32(),this.bottom=t.readInt32()):(this.bottom=i,this.right=s,this.top=r,this.left=e)}return t.prototype.clone=function(){return new t(null,this.left,this.top,this.right,this.bottom)},t.prototype.toString=function(){return"{left: "+this.left+", top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+"}"},t.prototype.empty=function(){return this.left>=this.right||this.top>=this.bottom},t.prototype.intersect=function(e){return this.empty()||e.empty()||this.left>=e.right||this.top>=e.bottom||this.right<=e.left||this.bottom<=e.top?null:new t(null,Math.max(this.left,e.left),Math.max(this.top,e.top),Math.min(this.right,e.right),Math.min(this.bottom,e.bottom))},t}(),l=function(){function t(t,e,r){null!=t?(this.cx=t.readUint32(),this.cy=t.readUint32()):(this.cx=e,this.cy=r)}return t.prototype.clone=function(){return new t(null,this.cx,this.cy)},t.prototype.toString=function(){return"{cx: "+this.cx+", cy: "+this.cy+"}"},t}(),a=function(){function t(t){this.type=t}return t.prototype.clone=function(){throw new s.EMFJSError("clone not implemented")},t.prototype.toString=function(){throw new s.EMFJSError("toString not implemented")},t}()},"./src/emfjs/Region.ts":/*!*****************************!*\
  !*** ./src/emfjs/Region.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{CreateSimpleRegion:()=>a,Region:()=>l,Scan:()=>h});var s,i=r(/*! ./Helper */"./src/emfjs/Helper.ts"),o=r(/*! ./Primitives */"./src/emfjs/Primitives.ts"),n=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e,r){var s=t.call(this,"region")||this;if(null!=e){if(32!==e.readUint32())throw new i.EMFJSError("Invalid region header");e.skip(4);var n=e.readUint32();if(16*n!==e.readUint32())throw new i.EMFJSError("Invalid region data");s.bounds=new o.RectL(e),s.scans=[];for(var l=void 0,a=0;a<n;a++){var p=new o.RectL(e);l||l.top!==p.top||l.bottom!==p.bottom?(l=new h(p),s.scans.push(l)):l.append(p)}s._updateComplexity()}else if(null!=r){if(s.bounds=null!=r.bounds?r.bounds.clone():null,null!=r.scans){s.scans=[];for(var a=0;a<r.scans.length;a++)s.scans.push(r.scans[a].clone())}else s.scans=null;s.complexity=r.complexity}else s.bounds=null,s.scans=null,s.complexity=0;return s}return n(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return"{complexity: "+["null","simple","complex"][this.complexity]+" bounds: "+(null!=this.bounds?this.bounds.toString():"[none]")+" #scans: "+(null!=this.scans?this.scans.length:"[none]")+"}"},e.prototype._updateComplexity=function(){if(null==this.bounds)this.complexity=0,this.scans=null;else if(this.bounds.empty())this.complexity=0,this.scans=null,this.bounds=null;else if(null==this.scans)this.complexity=1;else if(this.complexity=2,1===this.scans.length){var t=this.scans[0];if(t.top===this.bounds.top&&t.bottom===this.bounds.bottom&&1===t.scanlines.length){var e=t.scanlines[0];e.left===this.bounds.left&&e.right===this.bounds.right&&(this.scans=null,this.complexity=1)}}},e.prototype.subtract=function(t){if(i.Helper.log("[emf] Region "+this.toString()+" subtract "+t.toString()),null!=this.bounds&&null!=this.bounds.intersect(t)){null==this.scans&&(this.scans=[],this.scans.push(new h(new o.RectL(null,this.bounds.left,this.bounds.top,this.bounds.right,this.bounds.bottom))),this.complexity=2);for(var e=0;e<this.scans.length;){var r=this.scans[e];if(r.bottom>=t.top){var s=r.clone();r.bottom=t.top-1,s.top=t.top,r.top>=r.bottom?this.scans[e]=s:(i.Helper.log("[emf] Region split top scan "+e+" for substraction"),this.scans.splice(++e,0,s));break}e++}for(var n=e;e<this.scans.length;){var r=this.scans[e];if(r.top>t.bottom)break;if(r.bottom>t.bottom){var s=r.clone();r.bottom=t.bottom,s.top=t.bottom+1,r.top>=r.bottom?this.scans[e]=s:(i.Helper.log("[emf] Region split bottom scan "+e+" for substraction"),this.scans.splice(++e,0,s));break}e++}if(n<this.scans.length){var l=e;for(e=n;e<l;){var r=this.scans[e];if(!r.subtract(t.left,t.right)){i.Helper.log("[emf] Region remove now empty scan "+e+" due to subtraction"),this.scans.splice(e,1),l--;continue}e++}}if(null!=this.scans){for(var a,p=void 0,c=void 0,u=void 0,d=this.scans.length,E=0;E<d;E++){var r=this.scans[E];0===E&&(a=r.top),E===d-1&&(u=r.bottom);var f=r.scanlines.length;if(f>0){var T=r.scanlines[0];(null==p||T.left<p)&&(p=T.left),T=r.scanlines[f-1],(null==c||T.right>c)&&(c=T.right)}}null!=p&&null!=a&&null!=c&&null!=u?(this.bounds=new o.RectL(null,p,a,c,u),this._updateComplexity()):(this.bounds=null,this.scans=null,this.complexity=0)}else this._updateComplexity()}i.Helper.log("[emf] Region subtraction -> "+this.toString())},e.prototype.intersect=function(t){if(i.Helper.log("[emf] Region "+this.toString()+" intersect with "+t.toString()),null!=this.bounds){if(this.bounds=this.bounds.intersect(t),null!=this.bounds){if(null!=this.scans){for(var e=0;e<this.scans.length;){var r=this.scans[e];if(r.bottom<this.bounds.top)e++;else break}for(e>0&&(i.Helper.log("[emf] Region remove "+e+" scans from top"),this.scans.splice(0,e),this.scans.length>0&&(this.scans[0].top=this.bounds.top)),e=0;e<this.scans.length;){var r=this.scans[e];if(r.top>this.bounds.bottom){i.Helper.log("[emf] Region remove "+(this.scans.length-e)+" scans from bottom"),this.scans.splice(e,this.scans.length-e);break}if(!r.intersect(this.bounds.left,this.bounds.right)){i.Helper.log("[emf] Region remove now empty scan "+e+" due to intersection"),this.scans.splice(e,1);continue}e++}this.scans.length>0&&(this.scans[this.scans.length-1].bottom=this.bounds.bottom),this._updateComplexity()}}else this.scans=null,this.complexity=0}i.Helper.log("[emf] Region intersection -> "+this.toString())},e.prototype.offset=function(t,e){if(null!=this.bounds&&(this.bounds.left+=t,this.bounds.top+=e,this.bounds.right+=t,this.bounds.bottom+=e),null!=this.scans)for(var r=this.scans.length,s=0;s<r;s++){var i=this.scans[s];i.top+=e,i.bottom+=e;for(var o=i.scanlines.length,n=0;n<o;n++){var l=i.scanlines[n];l.left+=t,l.right+=t}}},e}(o.Obj);function a(t,e,r,s){var i=new l(null,null);return i.bounds=new o.RectL(null,t,e,r,s),i._updateComplexity(),i}var h=function(){function t(t,e){if(null!=t)this.top=t.top,this.bottom=t.bottom,this.scanlines=[{left:t.left,right:t.right}];else if(null!=e){this.top=e.top,this.bottom=e.bottom,this.scanlines=[];for(var r=0;r<e.scanlines.length;r++){var s=e.scanlines[r];this.scanlines.push({left:s.left,right:s.right})}}}return t.prototype.clone=function(){return new t(null,this)},t.prototype.append=function(t){this.scanlines.push({left:t.left,right:t.right})},t.prototype.subtract=function(t,e){for(r=0;r<this.scanlines.length;){var r,s=this.scanlines[r];if(s.left<=t){if(s.right>=t&&(s.right=t-1,s.left>=s.right)){this.scanlines.splice(r,1);continue}r++}else break}for(var i=r,o=0;r<this.scanlines.length;){var s=this.scanlines[r];if(s.right>e){s.left=e,o=r-i,s.left>=s.right&&o++;break}r++}return o>0&&i<this.scanlines.length&&this.scanlines.splice(i,o),this.scanlines.length>0},t.prototype.intersect=function(t,e){for(var r=0;r<this.scanlines.length;r++){var s=this.scanlines[r];if(s.left>=t||s.right>=t){r>0&&this.scanlines.splice(0,r);break}}if(this.scanlines.length>0){var s=this.scanlines[0];s.left<t&&(s.left=t);for(var r=0;r<this.scanlines.length;r++)if((s=this.scanlines[r]).left>e){this.scanlines.splice(r,this.scanlines.length-r);break}this.scanlines.length>0&&(s=this.scanlines[this.scanlines.length-1]).right>e&&(s.right=e)}return this.scanlines.length>0},t}()},"./src/emfjs/Renderer.ts":/*!*******************************!*\
  !*** ./src/emfjs/Renderer.ts ***!
  \*******************************/(t,e,r)=>{r.r(e),r.d(e,{Renderer:()=>a});var s=r(/*! ../util */"./src/util/index.ts"),i=r(/*! ./Blob */"./src/emfjs/Blob.ts"),o=r(/*! ./EMFRecords */"./src/emfjs/EMFRecords.ts"),n=r(/*! ./GDIContext */"./src/emfjs/GDIContext.ts"),l=r(/*! ./Helper */"./src/emfjs/Helper.ts"),a=function(){function t(t){this.parse(t),l.Helper.log("EMFJS.Renderer instantiated")}return t.prototype.render=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");return this._render(new s.SVG(e),t.mapMode,t.wExt,t.hExt,t.xExt,t.yExt),e.setAttribute("viewBox",[0,0,t.xExt,t.yExt].join(" ")),e.setAttribute("preserveAspectRatio","none"),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e},t.prototype.parse=function(t){this._img=null;var e=new i.Blob(t);if(1!==e.readUint32())throw new l.EMFJSError("Not an EMF file");var r=e.readUint32();if(r%4!=0)throw new l.EMFJSError("Not an EMF file");if(this._img=new h(e,r),null==this._img)throw new l.EMFJSError("Format not recognized")},t.prototype._render=function(t,e,r,s,i,o){var a=new n.GDIContext(t);a.setWindowExtEx(r,s),a.setViewportExtEx(i,o),a.setMapMode(e),l.Helper.log("[EMF] BEGIN RENDERING --->"),this._img.render(a),l.Helper.log("[EMF] <--- DONE RENDERING")},t}(),h=function(){function t(t,e){this._hdrsize=e,this._records=new o.EMFRecords(t,this._hdrsize)}return t.prototype.render=function(t){this._records.play(t)},t}()},"./src/emfjs/Style.ts":/*!****************************!*\
  !*** ./src/emfjs/Style.ts ***!
  \****************************/(t,e,r)=>{r.r(e),r.d(e,{Brush:()=>p,ColorRef:()=>a,Font:()=>h,Pen:()=>c});var s,i=r(/*! ./Bitmap */"./src/emfjs/Bitmap.ts"),o=r(/*! ./Helper */"./src/emfjs/Helper.ts"),n=r(/*! ./Primitives */"./src/emfjs/Primitives.ts"),l=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(){function t(t,e,r,s){null!=t?(this.r=t.readUint8(),this.g=t.readUint8(),this.b=t.readUint8(),t.skip(1)):(this.r=e,this.g=r,this.b=s)}return t.prototype.clone=function(){return new t(null,this.r,this.g,this.b)},t.prototype.toHex=function(){return(16777216+(this.r<<16|this.g<<8|this.b)).toString(16).slice(1)},t.prototype.toString=function(){return"{r: "+this.r+", g: "+this.g+", b: "+this.b+"}"},t}(),h=function(t){function e(e,r){var s=t.call(this,"font")||this;if(null!=e){s.height=e.readInt32(),s.width=e.readInt32(),s.escapement=e.readInt32(),s.orientation=e.readInt32(),s.weight=e.readInt32(),s.italic=e.readUint8(),s.underline=e.readUint8(),s.strikeout=e.readUint8(),s.charset=e.readUint8(),s.outprecision=e.readUint8(),s.clipprecision=e.readUint8(),s.quality=e.readUint8();var i=e.readUint8();s.pitch=15&i,s.family=i>>6&3;var o=e.pos;s.facename=e.readFixedSizeUnicodeString(Math.min(r-(e.pos-o),32))}else null!=r?(s.height=r.height,s.width=r.width,s.escapement=r.escapement,s.orientation=r.orientation,s.weight=r.weight,s.italic=r.italic,s.underline=r.underline,s.strikeout=r.strikeout,s.charset=r.charset,s.outprecision=r.outprecision,s.clipprecision=r.clipprecision,s.quality=r.quality,s.pitch=r.pitch,s.family=r.family,s.facename=r.facename):(s.height=-80,s.width=0,s.escapement=0,s.orientation=0,s.weight=400,s.italic=0,s.underline=0,s.strikeout=0,s.charset=0,s.outprecision=0,s.clipprecision=0,s.quality=0,s.pitch=0,s.family=0,s.facename="Helvetica");return s}return l(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return JSON.stringify(this)},e}(n.Obj),p=function(t){function e(e,r){var s=t.call(this,"brush")||this;if(null!=e){var n=e.pos;switch(s.style=e.readUint32(),s.style){case o.Helper.GDI.BrushStyle.BS_SOLID:s.color=new a(e);break;case o.Helper.GDI.BrushStyle.BS_PATTERN:s.pattern=new i.DIBitmap(e);break;case o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:s.dibpatternpt=new i.DIBitmap(e);break;case o.Helper.GDI.BrushStyle.BS_HATCHED:s.color=new a(e),s.hatchstyle=e.readUint32()}e.seek(n+12)}else switch(s.style=r.style,s.style){case o.Helper.GDI.BrushStyle.BS_SOLID:s.color=r.color.clone();break;case o.Helper.GDI.BrushStyle.BS_PATTERN:s.pattern=r.pattern;break;case o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:s.dibpatternpt=r.dibpatternpt;break;case o.Helper.GDI.BrushStyle.BS_HATCHED:s.color=r.color.clone(),s.hatchstyle=r.hatchstyle}return s}return l(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){var t="{style: "+this.style;switch(this.style){case o.Helper.GDI.BrushStyle.BS_SOLID:t+=", color: "+this.color.toString();break;case o.Helper.GDI.BrushStyle.BS_HATCHED:t+=", color: "+this.color.toString()+", hatchstyle: "+this.hatchstyle}return t+"}"},e}(n.Obj),c=function(t){function e(e,r,s,i,o){var l=t.call(this,"pen")||this;return null!=e?null!=r?(l.style=255&e.readUint32(),l.width=e.readUint32(),l.brush=new p(e),l.color=null!=l.brush.color?l.brush.color.clone():new a(null,0,0,0)):(l.style=255&e.readUint32(),l.width=new n.PointL(e).x,l.color=new a(e)):(l.style=r,l.width=s,null!=i&&(l.color=i),null!=o&&(l.brush=o)),l}return l(e,t),e.prototype.clone=function(){return new e(null,this.style,this.width,null!=this.color?this.color.clone():null,null!=this.brush?this.brush.clone():null)},e.prototype.toString=function(){return"{style: "+this.style+", width: "+this.width+", color: "+(null!=this.color?this.color.toString():"none")+"}"},e}(n.Obj)},"./src/util/SVG.ts":/*!*************************!*\
  !*** ./src/util/SVG.ts ***!
  \*************************/(t,e,r)=>{r.r(e),r.d(e,{SVG:()=>o,SVGFilters:()=>s,SVGPathBuilder:()=>i});var s=function(){function t(){}return t.prototype.flood=function(t,e,r,s,i){var o=document.createElementNS("http://www.w3.org/2000/svg","feFlood");e&&o.setAttribute("id",e),o.setAttribute("flood-color",r),o.setAttribute("flood-opacity",s.toString()),t.appendChild(o)},t.prototype.composite=function(t,e,r,s,i,o,n,l,a){var h=document.createElementNS("http://www.w3.org/2000/svg","feComposite");e&&h.setAttribute("id",e),h.setAttribute("in",r),h.setAttribute("in2",s),t.appendChild(h)},t}(),i=function(){function t(){this._path=""}return t.prototype.move=function(t,e){this._path+=" M ".concat(t," ").concat(e)},t.prototype.path=function(){return this._path.substr(1)},t.prototype.line=function(t){var e=this;t.forEach(function(t){e._path+=" L ".concat(t[0]," ").concat(t[1])})},t.prototype.curveC=function(t,e,r,s,i,o){this._path+=" C ".concat(t," ").concat(e,", ").concat(r," ").concat(s,", ").concat(i," ").concat(o)},t.prototype.close=function(){this._path+=" Z"},t}(),o=function(){function t(t){this.filters=new s,this._defs=void 0,this._svg=t}return t.prototype.svg=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("x",e.toString()),n.setAttribute("y",r.toString()),n.setAttribute("width",s.toString()),n.setAttribute("height",i.toString()),this._appendSettings(o,n),null!=t?t.appendChild(n):this._svg.appendChild(n),n},t.prototype.image=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","image");return l.setAttribute("x",e.toString()),l.setAttribute("y",r.toString()),l.setAttribute("width",s.toString()),l.setAttribute("height",i.toString()),l.setAttributeNS("http://www.w3.org/1999/xlink","href",o),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.rect=function(t,e,r,s,i,o,n,l){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");return a.setAttribute("x",e.toString()),a.setAttribute("y",r.toString()),a.setAttribute("width",s.toString()),a.setAttribute("height",i.toString()),void 0!==o&&(o instanceof Number?a.setAttribute("rx",o.toString()):o instanceof Object&&this._appendSettings(o,a)),void 0!==n&&a.setAttribute("ry",n.toString()),this._appendSettings(l,a),t.appendChild(a),a},t.prototype.line=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",e.toString()),n.setAttribute("y1",r.toString()),n.setAttribute("x2",s.toString()),n.setAttribute("y2",i.toString()),this._appendSettings(o,n),t.appendChild(n),n},t.prototype.polygon=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points",e.map(function(t){return t.join(",")}).join(" ")),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.polyline=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","polyline");return s.setAttribute("points",e.map(function(t){return t.join(",")}).join(" ")),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.ellipse=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","ellipse");return n.setAttribute("cx",e.toString()),n.setAttribute("cy",r.toString()),n.setAttribute("rx",s.toString()),n.setAttribute("ry",i.toString()),this._appendSettings(o,n),t.appendChild(n),n},t.prototype.path=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",e.path()),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.text=function(t,e,r,s,i){var o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",e.toString()),o.setAttribute("y",r.toString()),this._appendSettings(i,o);var n=document.createTextNode(s);return o.appendChild(n),t.appendChild(o),o},t.prototype.filter=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","filter");return l.setAttribute("x",r.toString()),l.setAttribute("y",s.toString()),l.setAttribute("width",i.toString()),l.setAttribute("height",o.toString()),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.pattern=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","pattern");return e&&l.setAttribute("id",e),l.setAttribute("x",r.toString()),l.setAttribute("y",s.toString()),l.setAttribute("width",i.toString()),l.setAttribute("height",o.toString()),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.defs=function(){if(void 0===this._defs){var t=document.createElementNS("http://www.w3.org/2000/svg","defs");this._svg.appendChild(t),this._defs=t}return this._defs},t.prototype.clipPath=function(t,e,r,s){var i=document.createElementNS("http://www.w3.org/2000/svg","clipPath");return e&&i.setAttribute("id",e),void 0===r&&(r="userSpaceOnUse"),i.setAttribute("clipPathUnits",r),this._appendSettings(s,i),t.appendChild(i),i},t.prototype.createPath=function(){return new i},t.prototype._appendSettings=function(t,e){void 0!==t&&Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})},t}()},"./src/util/index.ts":/*!***************************!*\
  !*** ./src/util/index.ts ***!
  \***************************/(t,e,r)=>{r.r(e),r.d(e,{SVG:()=>s.SVG});var s=r(/*! ./SVG */"./src/util/SVG.ts")}},s={};function i(t){var e=s[t];if(void 0!==e)return e.exports;var o=s[t]={exports:{}};return r[t](o,o.exports,i),o.exports}i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(/*!****************************!*\
  !*** ./src/emfjs/index.ts ***!
  \****************************/i.r(o),i.d(o,{Error:()=>e.EMFJSError,Renderer:()=>t.Renderer,loggingEnabled:()=>e.loggingEnabled}),t=i(/*! ./Renderer */"./src/emfjs/Renderer.ts"),e=i(/*! ./Helper */"./src/emfjs/Helper.ts"),o)})(),t.exports=e()},57274:function(t){var e;e=()=>(()=>{"use strict";var t,e,r={"./src/util/SVG.ts":/*!*************************!*\
  !*** ./src/util/SVG.ts ***!
  \*************************/(t,e,r)=>{r.r(e),r.d(e,{SVG:()=>o,SVGFilters:()=>s,SVGPathBuilder:()=>i});var s=function(){function t(){}return t.prototype.flood=function(t,e,r,s,i){var o=document.createElementNS("http://www.w3.org/2000/svg","feFlood");e&&o.setAttribute("id",e),o.setAttribute("flood-color",r),o.setAttribute("flood-opacity",s.toString()),t.appendChild(o)},t.prototype.composite=function(t,e,r,s,i,o,n,l,a){var h=document.createElementNS("http://www.w3.org/2000/svg","feComposite");e&&h.setAttribute("id",e),h.setAttribute("in",r),h.setAttribute("in2",s),t.appendChild(h)},t}(),i=function(){function t(){this._path=""}return t.prototype.move=function(t,e){this._path+=" M ".concat(t," ").concat(e)},t.prototype.path=function(){return this._path.substr(1)},t.prototype.line=function(t){var e=this;t.forEach(function(t){e._path+=" L ".concat(t[0]," ").concat(t[1])})},t.prototype.curveC=function(t,e,r,s,i,o){this._path+=" C ".concat(t," ").concat(e,", ").concat(r," ").concat(s,", ").concat(i," ").concat(o)},t.prototype.close=function(){this._path+=" Z"},t}(),o=function(){function t(t){this.filters=new s,this._defs=void 0,this._svg=t}return t.prototype.svg=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("x",e.toString()),n.setAttribute("y",r.toString()),n.setAttribute("width",s.toString()),n.setAttribute("height",i.toString()),this._appendSettings(o,n),null!=t?t.appendChild(n):this._svg.appendChild(n),n},t.prototype.image=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","image");return l.setAttribute("x",e.toString()),l.setAttribute("y",r.toString()),l.setAttribute("width",s.toString()),l.setAttribute("height",i.toString()),l.setAttributeNS("http://www.w3.org/1999/xlink","href",o),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.rect=function(t,e,r,s,i,o,n,l){var a=document.createElementNS("http://www.w3.org/2000/svg","rect");return a.setAttribute("x",e.toString()),a.setAttribute("y",r.toString()),a.setAttribute("width",s.toString()),a.setAttribute("height",i.toString()),void 0!==o&&(o instanceof Number?a.setAttribute("rx",o.toString()):o instanceof Object&&this._appendSettings(o,a)),void 0!==n&&a.setAttribute("ry",n.toString()),this._appendSettings(l,a),t.appendChild(a),a},t.prototype.line=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","line");return n.setAttribute("x1",e.toString()),n.setAttribute("y1",r.toString()),n.setAttribute("x2",s.toString()),n.setAttribute("y2",i.toString()),this._appendSettings(o,n),t.appendChild(n),n},t.prototype.polygon=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","polygon");return s.setAttribute("points",e.map(function(t){return t.join(",")}).join(" ")),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.polyline=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","polyline");return s.setAttribute("points",e.map(function(t){return t.join(",")}).join(" ")),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.ellipse=function(t,e,r,s,i,o){var n=document.createElementNS("http://www.w3.org/2000/svg","ellipse");return n.setAttribute("cx",e.toString()),n.setAttribute("cy",r.toString()),n.setAttribute("rx",s.toString()),n.setAttribute("ry",i.toString()),this._appendSettings(o,n),t.appendChild(n),n},t.prototype.path=function(t,e,r){var s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("d",e.path()),this._appendSettings(r,s),t.appendChild(s),s},t.prototype.text=function(t,e,r,s,i){var o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",e.toString()),o.setAttribute("y",r.toString()),this._appendSettings(i,o);var n=document.createTextNode(s);return o.appendChild(n),t.appendChild(o),o},t.prototype.filter=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","filter");return l.setAttribute("x",r.toString()),l.setAttribute("y",s.toString()),l.setAttribute("width",i.toString()),l.setAttribute("height",o.toString()),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.pattern=function(t,e,r,s,i,o,n){var l=document.createElementNS("http://www.w3.org/2000/svg","pattern");return e&&l.setAttribute("id",e),l.setAttribute("x",r.toString()),l.setAttribute("y",s.toString()),l.setAttribute("width",i.toString()),l.setAttribute("height",o.toString()),this._appendSettings(n,l),t.appendChild(l),l},t.prototype.defs=function(){if(void 0===this._defs){var t=document.createElementNS("http://www.w3.org/2000/svg","defs");this._svg.appendChild(t),this._defs=t}return this._defs},t.prototype.clipPath=function(t,e,r,s){var i=document.createElementNS("http://www.w3.org/2000/svg","clipPath");return e&&i.setAttribute("id",e),void 0===r&&(r="userSpaceOnUse"),i.setAttribute("clipPathUnits",r),this._appendSettings(s,i),t.appendChild(i),i},t.prototype.createPath=function(){return new i},t.prototype._appendSettings=function(t,e){void 0!==t&&Object.keys(t).forEach(function(r){e.setAttribute(r,t[r])})},t}()},"./src/util/index.ts":/*!***************************!*\
  !*** ./src/util/index.ts ***!
  \***************************/(t,e,r)=>{r.r(e),r.d(e,{SVG:()=>s.SVG});var s=r(/*! ./SVG */"./src/util/SVG.ts")},"./src/wmfjs/Bitmap.ts":/*!*****************************!*\
  !*** ./src/wmfjs/Bitmap.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{Bitmap16:()=>p,BitmapInfo:()=>a,DIBitmap:()=>h,PatternBitmap16:()=>c});var s,i=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),o=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),n=function(){function t(t,e){e&&t.skip(4),this.width=t.readUint16(),this.height=t.readUint16(),this.planes=t.readUint16(),this.bitcount=t.readUint16()}return t.prototype.colors=function(){return this.bitcount<=8?1<<this.bitcount:0},t}(),l=function(){function t(t,e){e&&t.skip(4),this.width=t.readInt32(),this.height=t.readInt32(),this.planes=t.readUint16(),this.bitcount=t.readUint16(),this.compression=t.readUint32(),this.sizeimage=t.readUint32(),this.xpelspermeter=t.readInt32(),this.ypelspermeter=t.readInt32(),this.clrused=t.readUint32(),this.clrimportant=t.readUint32()}return t.prototype.colors=function(){return 0!==this.clrused?this.clrused<256?this.clrused:256:this.bitcount>8?0:1<<this.bitcount},t}(),a=function(){function t(t,e){this._reader=t,this._offset=t.pos,this._usergb=e;var r=t.readUint32();if(this._infosize=r,r===i.Helper.GDI.BITMAPCOREHEADER_SIZE)this._header=new n(t,!1),this._infosize+=this._header.colors()*(e?3:2);else{this._header=new l(t,!1);var s=this._header.compression===i.Helper.GDI.BitmapCompression.BI_BITFIELDS?3:0;r<=i.Helper.GDI.BITMAPINFOHEADER_SIZE+4*s&&(this._infosize=i.Helper.GDI.BITMAPINFOHEADER_SIZE+4*s),this._infosize+=this._header.colors()*(e?4:2)}}return t.prototype.getWidth=function(){return this._header.width},t.prototype.getHeight=function(){return Math.abs(this._header.height)},t.prototype.infosize=function(){return this._infosize},t.prototype.header=function(){return this._header},t}(),h=function(){function t(t,e){this._reader=t,this._offset=t.pos,this._size=e,this._info=new a(t,!0)}return t.prototype.getWidth=function(){return this._info.getWidth()},t.prototype.getHeight=function(){return this._info.getHeight()},t.prototype.base64ref=function(){var t,e=this._reader.pos;this._reader.seek(this._offset);var r="image/bmp",s=this._info.header();if(s instanceof l&&null!=s.compression)switch(s.compression){case i.Helper.GDI.BitmapCompression.BI_JPEG:r="data:image/jpeg";break;case i.Helper.GDI.BitmapCompression.BI_PNG:r="data:image/png";break;default:t=this.makeBitmapFileHeader()}else t=this.makeBitmapFileHeader();null!=t?t+=this._reader.readBinary(this._size):t=this._reader.readBinary(this._size);var o="data:"+r+";base64,"+btoa(t);return this._reader.seek(e),o},t.prototype.makeBitmapFileHeader=function(){var t=new Uint8Array(new ArrayBuffer(14));return t[0]=66,t[1]=77,i.Helper._writeUint32Val(t,2,this._size+14),i.Helper._writeUint32Val(t,10,this._info.infosize()+14),i.Helper._blobToBinary(t)},t}(),p=function(){function t(t,e){if(null!=t){if(this._reader=t,this._offset=t.pos,this._size=e,this.type=t.readInt16(),this.width=t.readInt16(),this.height=t.readInt16(),this.widthBytes=t.readInt16(),this.planes=t.readUint8(),this.bitsPixel=t.readUint8(),this.bitsOffset=t.pos,this.bitsSize=(this.width*this.bitsPixel+15>>4<<1)*this.height,this.bitsSize>e-10)throw new i.WMFJSError("Bitmap should have "+this.bitsSize+" bytes, but has "+(e-10))}else this._reader=e._reader,this._offset=e._offset,this._size=e._size,this.type=e.type,this.width=e.width,this.height=e.height,this.widthBytes=e.widthBytes,this.planes=e.planes,this.bitsPixel=e.bitsPixel,this.bitsOffset=e.bitsOffset,this.bitsSize=e.bitsSize}return t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.clone=function(){return new t(null,this)},t}(),c=function(t){function e(e,r){var s=t.call(this,e,r)||this;return null!=e&&(s.bitsOffset+=22),s}return o(e,t),e.prototype.clone=function(){return new e(null,this)},e}(p)},"./src/wmfjs/Blob.ts":/*!***************************!*\
  !*** ./src/wmfjs/Blob.ts ***!
  \***************************/(t,e,r)=>{r.r(e),r.d(e,{Blob:()=>i});var s=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),i=function(){function t(e,r){e instanceof t?(this.blob=e.blob,this.data=e.data,this.pos=r||e.pos):(this.blob=e,this.data=new Uint8Array(e),this.pos=r||0)}return t.prototype.eof=function(){return this.pos>=this.data.length},t.prototype.seek=function(t){if(t<0||t>this.data.length)throw new s.WMFJSError("Invalid seek position");this.pos=t},t.prototype.skip=function(t){var e=this.pos+t;if(e>this.data.length)throw new s.WMFJSError("Unexpected end of file");this.pos=e},t.prototype.readBinary=function(t){if(this.pos+t>this.data.length)throw new s.WMFJSError("Unexpected end of file");for(var e="";t-- >0;)e+=String.fromCharCode(this.data[this.pos++]);return e},t.prototype.readInt8=function(){if(this.pos+1>this.data.length)throw new s.WMFJSError("Unexpected end of file");return this.data[this.pos++]},t.prototype.readUint8=function(){return this.readInt8()>>>0},t.prototype.readInt32=function(){if(this.pos+4>this.data.length)throw new s.WMFJSError("Unexpected end of file");var t=this.data[this.pos++];return t|=this.data[this.pos++]<<8,t|=this.data[this.pos++]<<16,t|=this.data[this.pos++]<<24},t.prototype.readUint32=function(){return this.readInt32()>>>0},t.prototype.readUint16=function(){if(this.pos+2>this.data.length)throw new s.WMFJSError("Unexpected end of file");return this.data[this.pos++]|this.data[this.pos++]<<8},t.prototype.readInt16=function(){var t=this.readUint16();return t>32767&&(t-=65536),t},t.prototype.readString=function(t){if(this.pos+t>this.data.length)throw new s.WMFJSError("Unexpected end of file");for(var e="",r=0;r<t;r++)e+=String.fromCharCode(this.data[this.pos++]>>>0);return e},t.prototype.readNullTermString=function(t){var e="";if(t>0){t--;for(var r=0;r<t;r++){if(this.pos+r+1>this.data.length)throw new s.WMFJSError("Unexpected end of file");var i=this.data[this.pos+r]>>>0;if(0===i)break;e+=String.fromCharCode(i)}}return e},t}()},"./src/wmfjs/GDIContext.ts":/*!*********************************!*\
  !*** ./src/wmfjs/GDIContext.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{GDIContext:()=>a});var s=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),i=r(/*! ./Primitives */"./src/wmfjs/Primitives.ts"),o=r(/*! ./Region */"./src/wmfjs/Region.ts"),n=r(/*! ./Style */"./src/wmfjs/Style.ts"),l=function(t,e){if(null!=t)for(var r in this._svggroup=t._svggroup,this._svgclipChanged=t._svgclipChanged,this._svgtextbkfilter=t._svgtextbkfilter,this.mapmode=t.mapmode,this.stretchmode=t.stretchmode,this.textalign=t.textalign,this.bkmode=t.bkmode,this.textcolor=t.textcolor.clone(),this.bkcolor=t.bkcolor.clone(),this.polyfillmode=t.polyfillmode,this.wx=t.wx,this.wy=t.wy,this.ww=t.ww,this.wh=t.wh,this.vx=t.vx,this.vy=t.vy,this.vw=t.vw,this.vh=t.vh,this.x=t.x,this.y=t.y,this.clip=t.clip,this.ownclip=!1,this.selected={},t.selected)this.selected[r]=t.selected[r];else for(var r in this._svggroup=null,this._svgclipChanged=!1,this._svgtextbkfilter=null,this.mapmode=s.Helper.GDI.MapMode.MM_ANISOTROPIC,this.stretchmode=s.Helper.GDI.StretchMode.COLORONCOLOR,this.textalign=0,this.bkmode=s.Helper.GDI.MixMode.OPAQUE,this.textcolor=new n.ColorRef(null,0,0,0),this.bkcolor=new n.ColorRef(null,255,255,255),this.polyfillmode=s.Helper.GDI.PolyFillMode.ALTERNATE,this.wx=0,this.wy=0,this.ww=0,this.wh=0,this.vx=0,this.vy=0,this.vw=0,this.vh=0,this.x=0,this.y=0,this.clip=null,this.ownclip=!1,this.selected={},e){var i=e[r];this.selected[r]=null!=i?i.clone():null}},a=function(){function t(t){this._svg=t,this._svgdefs=null,this._svgPatterns={},this._svgClipPaths={},this.defObjects={brush:new n.Brush(null,null),pen:new n.Pen(null,s.Helper.GDI.PenStyle.PS_SOLID,new i.PointS(null,1,1),new n.ColorRef(null,0,0,0),0,0),font:new n.Font(null,null),palette:null,region:null},this.state=new l(null,this.defObjects),this.statestack=[this.state],this.objects={}}return t.prototype.setMapMode=function(t){s.Helper.log("[gdi] setMapMode: mode="+t),this.state.mapmode=t,this.state._svggroup=null},t.prototype.setWindowOrg=function(t,e){s.Helper.log("[gdi] setWindowOrg: x="+t+" y="+e),this.state.wx=t,this.state.wy=e,this.state._svggroup=null},t.prototype.setWindowExt=function(t,e){s.Helper.log("[gdi] setWindowExt: x="+t+" y="+e),this.state.ww=t,this.state.wh=e,this.state._svggroup=null},t.prototype.offsetWindowOrg=function(t,e){s.Helper.log("[gdi] offsetWindowOrg: offX="+t+" offY="+e),this.state.wx+=t,this.state.wy+=e,this.state._svggroup=null},t.prototype.setViewportOrg=function(t,e){s.Helper.log("[gdi] setViewportOrg: x="+t+" y="+e),this.state.vx=t,this.state.vy=e,this.state._svggroup=null},t.prototype.setViewportExt=function(t,e){s.Helper.log("[gdi] setViewportExt: x="+t+" y="+e),this.state.vw=t,this.state.vh=e,this.state._svggroup=null},t.prototype.offsetViewportOrg=function(t,e){s.Helper.log("[gdi] offsetViewportOrg: offX="+t+" offY="+e),this.state.vx+=t,this.state.vy+=e,this.state._svggroup=null},t.prototype.saveDC=function(){s.Helper.log("[gdi] saveDC");var t=this.state;this.state=new l(this.state),this.statestack.push(t),this.state._svggroup=null},t.prototype.restoreDC=function(t){if(s.Helper.log("[gdi] restoreDC: saved="+t),this.statestack.length>1){if(-1===t)this.state=this.statestack.pop();else if(t<-1)throw new s.WMFJSError("restoreDC: relative restore not implemented");else if(t>1)throw new s.WMFJSError("restoreDC: absolute restore not implemented")}else throw new s.WMFJSError("No saved contexts");this.state._svggroup=null},t.prototype.escape=function(t,e,r,i){s.Helper.log("[gdi] escape: func="+t+" offset="+r+" count="+i)},t.prototype.setStretchBltMode=function(t){s.Helper.log("[gdi] setStretchBltMode: stretchMode="+t)},t.prototype.stretchDib=function(t,e,r,i,o,n,l,a,h,p,c){s.Helper.log("[gdi] stretchDib: srcX="+t+" srcY="+e+" srcW="+r+" srcH="+i+" dstX="+o+" dstY="+n+" dstW="+l+" dstH="+a+" rasterOp=0x"+h.toString(16)),t=this._todevX(t),e=this._todevY(e),r=this._todevW(r),i=this._todevH(i),o=this._todevX(o),n=this._todevY(n),l=this._todevW(l),a=this._todevH(a),s.Helper.log("[gdi] stretchDib: TRANSLATED: srcX="+t+" srcY="+e+" srcW="+r+" srcH="+i+" dstX="+o+" dstY="+n+" dstW="+l+" dstH="+a+" rasterOp=0x"+h.toString(16)+" colorUsage=0x"+p.toString(16)),this._pushGroup(),this._svg.image(this.state._svggroup,o,n,l,a,c.base64ref())},t.prototype.dibBits=function(t,e,r,i,o,n,l,a){s.Helper.log("[gdi] stretchDibBits: srcX="+t+" srcY="+e+" dstX="+r+" dstY="+i+" width="+o+" height="+n+" rasterOp=0x"+l.toString(16)),t=this._todevX(t),e=this._todevY(e),r=this._todevX(r),i=this._todevY(i),o=this._todevW(o),n=this._todevH(n),s.Helper.log("[gdi] dibBits: TRANSLATED: srcX="+t+" srcY="+e+"NaN"+r+" dstY="+i+" width="+o+" height="+n+" rasterOp=0x"+l.toString(16)),this._pushGroup(),this._svg.image(this.state._svggroup,r,i,o,n,a.base64ref())},t.prototype.stretchDibBits=function(t,e,r,i,o,n,l,a,h,p){s.Helper.log("[gdi] stretchDibBits: srcX="+t+" srcY="+e+" srcW="+r+" srcH="+i+" dstX="+o+" dstY="+n+" dstW="+l+" dstH="+a+" rasterOp=0x"+h.toString(16)),t=this._todevX(t),e=this._todevY(e),r=this._todevW(r),i=this._todevH(i),o=this._todevX(o),n=this._todevY(n),l=this._todevW(l),a=this._todevH(a),s.Helper.log("[gdi] stretchDibBits: TRANSLATED: srcX="+t+" srcY="+e+" srcW="+r+" srcH="+i+" dstX="+o+" dstY="+n+" dstW="+l+" dstH="+a+" rasterOp=0x"+h.toString(16)),this._pushGroup(),this._svg.image(this.state._svggroup,o,n,l,a,p.base64ref())},t.prototype.rectangle=function(t,e,r){s.Helper.log("[gdi] rectangle: rect="+t.toString()+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());var i=this._todevY(t.bottom),o=this._todevX(t.right),n=this._todevY(t.top),l=this._todevX(t.left);e=this._todevH(e),r=this._todevH(r),s.Helper.log("[gdi] rectangle: TRANSLATED: bottom="+i+" right="+o+" top="+n+" left="+l+" rh="+r+" rw="+e),this._pushGroup();var a=this._applyOpts(null,!0,!0,!1);this._svg.rect(this.state._svggroup,l,n,o-l,i-n,e/2,r/2,a)},t.prototype.textOut=function(t,e,r){s.Helper.log("[gdi] textOut: x="+t+" y="+e+" text="+r+" with font "+this.state.selected.font.toString()),t=this._todevX(t),e=this._todevY(e),s.Helper.log("[gdi] textOut: TRANSLATED: x="+t+" y="+e),this._pushGroup();var i=this._applyOpts(null,!1,!1,!0);if(0!==this.state.selected.font.escapement&&(i.transform="rotate("+[-this.state.selected.font.escapement/10,t,e]+")",i.style="dominant-baseline: middle; text-anchor: start;"),this.state.bkmode===s.Helper.GDI.MixMode.OPAQUE){if(null==this.state._svgtextbkfilter){var o=s.Helper._makeUniqueId("f"),n=this._svg.filter(this._getSvgDef(),o,0,0,1,1);this._svg.filters.flood(n,null,"#"+this.state.bkcolor.toHex(),1),this._svg.filters.composite(n,null,null,"SourceGraphic"),this.state._svgtextbkfilter=n}i.filter="url(#"+this.state._svgtextbkfilter.id+")"}this._svg.text(this.state._svggroup,t,e,r,i)},t.prototype.extTextOut=function(t,e,r,i,o,n){s.Helper.log("[gdi] extTextOut: x="+t+" y="+e+" text="+r+" with font "+this.state.selected.font.toString()),t=this._todevX(t),e=this._todevY(e),s.Helper.log("[gdi] extTextOut: TRANSLATED: x="+t+" y="+e),this._pushGroup();var l=this._applyOpts(null,!1,!1,!0);if(0!==this.state.selected.font.escapement&&(l.transform="rotate("+[-this.state.selected.font.escapement/10,t,e]+")",l.style="dominant-baseline: middle; text-anchor: start;"),this.state.bkmode===s.Helper.GDI.MixMode.OPAQUE){if(null==this.state._svgtextbkfilter){var a=s.Helper._makeUniqueId("f"),h=this._svg.filter(this._getSvgDef(),a,0,0,1,1);this._svg.filters.flood(h,null,"#"+this.state.bkcolor.toHex(),1),this._svg.filters.composite(h,null,null,"SourceGraphic"),this.state._svgtextbkfilter=h}l.filter="url(#"+this.state._svgtextbkfilter.id+")"}this._svg.text(this.state._svggroup,t,e,r,l)},t.prototype.lineTo=function(t,e){s.Helper.log("[gdi] lineTo: x="+t+" y="+e+" with pen "+this.state.selected.pen.toString());var r=this._todevX(t),i=this._todevY(e),o=this._todevX(this.state.x),n=this._todevY(this.state.y);this.state.x=t,this.state.y=e,s.Helper.log("[gdi] lineTo: TRANSLATED: toX="+r+" toY="+i+" fromX="+o+" fromY="+n),this._pushGroup();var l=this._applyOpts(null,!0,!1,!1);this._svg.line(this.state._svggroup,o,n,r,i,l)},t.prototype.moveTo=function(t,e){s.Helper.log("[gdi] moveTo: x="+t+" y="+e),this.state.x=t,this.state.y=e},t.prototype.polygon=function(t,e){s.Helper.log("[gdi] polygon: points="+t+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());for(var r=[],i=0;i<t.length;i++){var o=t[i];r.push([this._todevX(o.x),this._todevY(o.y)])}s.Helper.log("[gdi] polygon: TRANSLATED: pts="+r),e&&this._pushGroup();var n={"fill-rule":this.state.polyfillmode===s.Helper.GDI.PolyFillMode.ALTERNATE?"evenodd":"nonzero"};this._applyOpts(n,!0,!0,!1),this._svg.polygon(this.state._svggroup,r,n)},t.prototype.polyPolygon=function(t){s.Helper.log("[gdi] polyPolygon: polygons.length="+t.length+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());for(var e=t.length,r=0;r<e;r++)this.polygon(t[r],0===r)},t.prototype.polyline=function(t){s.Helper.log("[gdi] polyline: points="+t+" with pen "+this.state.selected.pen.toString());for(var e=[],r=0;r<t.length;r++){var i=t[r];e.push([this._todevX(i.x),this._todevY(i.y)])}s.Helper.log("[gdi] polyline: TRANSLATED: pts="+e),this._pushGroup();var o=this._applyOpts({fill:"none"},!0,!1,!1);this._svg.polyline(this.state._svggroup,e,o)},t.prototype.ellipse=function(t){s.Helper.log("[gdi] ellipse: rect="+t.toString()+" with pen "+this.state.selected.pen.toString()+" and brush "+this.state.selected.brush.toString());var e=this._todevY(t.bottom),r=this._todevX(t.right),i=this._todevY(t.top),o=this._todevX(t.left);s.Helper.log("[gdi] ellipse: TRANSLATED: bottom="+e+" right="+r+" top="+i+" left="+o),this._pushGroup();var n=(r-o)/2,l=(e-i)/2,a=this._applyOpts(null,!0,!0,!1);this._svg.ellipse(this.state._svggroup,o+n,i+l,n,l,a)},t.prototype.excludeClipRect=function(t){s.Helper.log("[gdi] excludeClipRect: rect="+t.toString()),this._getClipRgn().subtract(t)},t.prototype.intersectClipRect=function(t){s.Helper.log("[gdi] intersectClipRect: rect="+t.toString()),this._getClipRgn().intersect(t)},t.prototype.offsetClipRgn=function(t,e){s.Helper.log("[gdi] offsetClipRgn: offX="+t+" offY="+e),this._getClipRgn().offset(t,e)},t.prototype.setTextAlign=function(t){s.Helper.log("[gdi] setTextAlign: textAlignmentMode=0x"+t.toString(16)),this.state.textalign=t},t.prototype.setBkMode=function(t){s.Helper.log("[gdi] setBkMode: bkMode=0x"+t.toString(16)),this.state.bkmode=t},t.prototype.setTextColor=function(t){s.Helper.log("[gdi] setTextColor: textColor="+t.toString()),this.state.textcolor=t},t.prototype.setBkColor=function(t){s.Helper.log("[gdi] setBkColor: bkColor="+t.toString()),this.state.bkcolor=t,this.state._svgtextbkfilter=null},t.prototype.setPolyFillMode=function(t){s.Helper.log("[gdi] setPolyFillMode: polyFillMode="+t),this.state.polyfillmode=t},t.prototype.createBrush=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createBrush: brush="+t.toString()+" with handle "+e)},t.prototype.createFont=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createFont: font="+t.toString()+" with handle "+e)},t.prototype.createPen=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createPen: pen="+t.toString()+" width handle "+e)},t.prototype.createPalette=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createPalette: palette="+t.toString()+" width handle "+e)},t.prototype.createRegion=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createRegion: region="+t.toString()+" width handle "+e)},t.prototype.createPatternBrush=function(t){var e=this._storeObject(t);s.Helper.log("[gdi] createRegion: region="+t.toString()+" width handle "+e)},t.prototype.selectObject=function(t,e){var r=this._getObject(t);null!=r&&(null==e||r.type===e)?(this._selectObject(r),s.Helper.log("[gdi] selectObject: objIdx="+t+(r?" selected "+r.type+": "+r.toString():"[invalid index]"))):s.Helper.log("[gdi] selectObject: objIdx="+t+(r?" invalid object type: "+r.type:"[invalid index]"))},t.prototype.deleteObject=function(t){var e=this._deleteObject(t);s.Helper.log("[gdi] deleteObject: objIdx="+t+(e?" deleted object":"[invalid index]"))},t.prototype._pushGroup=function(){if(null==this.state._svggroup||this.state._svgclipChanged){this.state._svgclipChanged=!1,this.state._svgtextbkfilter=null;var t={viewBox:[this.state.vx,this.state.vy,this.state.vw,this.state.vh].join(" "),preserveAspectRatio:"none"};null!=this.state.clip?(s.Helper.log("[gdi] new svg x="+this.state.vx+" y="+this.state.vy+" width="+this.state.vw+" height="+this.state.vh+" with clipping"),t["clip-path"]="url(#"+this._getSvgClipPathForRegion(this.state.clip)+")"):s.Helper.log("[gdi] new svg x="+this.state.vx+" y="+this.state.vy+" width="+this.state.vw+" height="+this.state.vh+" without clipping"),this.state._svggroup=this._svg.svg(this.state._svggroup,this.state.vx,this.state.vy,this.state.vw,this.state.vh,t)}},t.prototype._storeObject=function(t){for(var e=0;null!=this.objects[e.toString()]&&e<=65535;)e++;return e>65535?(s.Helper.log("[gdi] Too many objects!"),-1):(this.objects[e.toString()]=t,e)},t.prototype._getObject=function(t){var e=this.objects[t.toString()];return null==e&&s.Helper.log("[gdi] No object with handle "+t),e},t.prototype._getSvgDef=function(){return null==this._svgdefs&&(this._svgdefs=this._svg.defs()),this._svgdefs},t.prototype._getSvgClipPathForRegion=function(t){for(var e in this._svgClipPaths)if(this._svgClipPaths[e]===t)return e;var r=s.Helper._makeUniqueId("c"),i=this._svg.clipPath(this._getSvgDef(),r,"userSpaceOnUse");switch(t.complexity){case 1:this._svg.rect(i,this._todevX(t.bounds.left),this._todevY(t.bounds.top),this._todevW(t.bounds.right-t.bounds.left),this._todevH(t.bounds.bottom-t.bounds.top),{fill:"black","stroke-width":0});break;case 2:for(var o=0;o<t.scans.length;o++)for(var n=t.scans[o],l=0;l<n.scanlines.length;l++){var a=n.scanlines[l];this._svg.rect(i,this._todevX(a.left),this._todevY(n.top),this._todevW(a.right-a.left),this._todevH(n.bottom-n.top),{fill:"black","stroke-width":0})}}return this._svgClipPaths[r]=t,r},t.prototype._getSvgPatternForBrush=function(t){for(var e in this._svgPatterns){var r,i,o;if(this._svgPatterns[e]===t)return e}switch(t.style){case s.Helper.GDI.BrushStyle.BS_PATTERN:r=t.pattern.getWidth(),i=t.pattern.getHeight();break;case s.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:r=t.dibpatternpt.getWidth(),i=t.dibpatternpt.getHeight(),o=t.dibpatternpt.base64ref();break;default:throw new s.WMFJSError("Invalid brush style")}var n=s.Helper._makeUniqueId("p"),l=this._svg.pattern(this._getSvgDef(),n,0,0,r,i,{patternUnits:"userSpaceOnUse"});return this._svg.image(l,0,0,r,i,o),this._svgPatterns[n]=t,n},t.prototype._selectObject=function(t){this.state.selected[t.type]=t,"region"===t.type&&(this.state._svgclipChanged=!0)},t.prototype._deleteObject=function(t){var e=this.objects[t.toString()];if(null!=e){for(var r=0;r<this.statestack.length;r++){var i=this.statestack[r];i.selected[e.type]===e&&(i.selected[e.type]=this.defObjects[e.type].clone())}return delete this.objects[t.toString()],!0}return s.Helper.log("[gdi] Cannot delete object with invalid handle "+t),!1},t.prototype._getClipRgn=function(){return null!=this.state.clip?this.state.ownclip||(this.state.clip=this.state.clip.clone()):null!=this.state.selected.region?this.state.clip=this.state.selected.region.clone():this.state.clip=(0,o.CreateSimpleRegion)(this.state.wx,this.state.wy,this.state.wx+this.state.ww,this.state.wy+this.state.wh),this.state.ownclip=!0,this.state.clip},t.prototype._todevX=function(t){return Math.floor((t-this.state.wx)*(this.state.vw/this.state.ww))+this.state.vx},t.prototype._todevY=function(t){return Math.floor((t-this.state.wy)*(this.state.vh/this.state.wh))+this.state.vy},t.prototype._todevW=function(t){return Math.floor(this.state.vw/this.state.ww*t)+this.state.vx},t.prototype._todevH=function(t){return Math.floor(this.state.vh/this.state.wh*t)+this.state.vy},t.prototype._tologicalX=function(t){return Math.floor((t-this.state.vx)/(this.state.vw/this.state.ww))+this.state.wx},t.prototype._tologicalY=function(t){return Math.floor((t-this.state.vy)/(this.state.vh/this.state.wh))+this.state.wy},t.prototype._tologicalW=function(t){return Math.floor(t/(this.state.vw/this.state.ww))+this.state.wx},t.prototype._tologicalH=function(t){return Math.floor(t/(this.state.vh/this.state.wh))+this.state.wy},t.prototype._applyOpts=function(t,e,r,i){if(null==t&&(t={}),e){var o=this.state.selected.pen;if(o.style!==s.Helper.GDI.PenStyle.PS_NULL){t.stroke="#"+o.color.toHex(),t["stroke-width"]=this._todevW(o.width.x);var n=void 0;(o.linecap&s.Helper.GDI.PenStyle.PS_ENDCAP_SQUARE)!=0?(t["stroke-linecap"]="square",n=1):(o.linecap&s.Helper.GDI.PenStyle.PS_ENDCAP_FLAT)!=0?(t["stroke-linecap"]="butt",n=t["stroke-width"]):(t["stroke-linecap"]="round",n=1),(o.join&s.Helper.GDI.PenStyle.PS_JOIN_BEVEL)!=0?t["stroke-linejoin"]="bevel":(o.join&s.Helper.GDI.PenStyle.PS_JOIN_MITER)!=0?t["stroke-linejoin"]="miter":t["stroke-linejoin"]="round";var l=4*t["stroke-width"],a=2*t["stroke-width"];switch(o.style){case s.Helper.GDI.PenStyle.PS_DASH:t["stroke-dasharray"]=[l,a].toString();break;case s.Helper.GDI.PenStyle.PS_DOT:t["stroke-dasharray"]=[n,a].toString();break;case s.Helper.GDI.PenStyle.PS_DASHDOT:t["stroke-dasharray"]=[l,a,n,a].toString();break;case s.Helper.GDI.PenStyle.PS_DASHDOTDOT:t["stroke-dasharray"]=[l,a,n,a,n,a].toString()}}}if(r){var h=this.state.selected.brush;switch(h.style){case s.Helper.GDI.BrushStyle.BS_SOLID:t.fill="#"+h.color.toHex();break;case s.Helper.GDI.BrushStyle.BS_PATTERN:case s.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:t.fill="url(#"+this._getSvgPatternForBrush(h)+")";break;case s.Helper.GDI.BrushStyle.BS_NULL:t.fill="none";break;default:s.Helper.log("[gdi] unsupported brush style: "+h.style),t.fill="none"}}if(i){var p=this.state.selected.font;t["font-family"]=p.facename,t["font-size"]=this._todevH(Math.abs(p.height)),t.fill="#"+this.state.textcolor.toHex()}return t},t}()},"./src/wmfjs/Helper.ts":/*!*****************************!*\
  !*** ./src/wmfjs/Helper.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{Helper:()=>a,WMFJSError:()=>o,loggingEnabled:()=>l});var s,i=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),o=function(t){function e(e){var r=this.constructor,s=t.call(this,e)||this;return Object.setPrototypeOf(s,r.prototype),s}return i(e,t),e}(Error),n=!0;function l(t){n=t}var a=function(){function t(){}return t.log=function(t){n&&console.log(t)},t._makeUniqueId=function(t){return"wmfjs_"+t+this._uniqueId++},t._writeUint32Val=function(t,e,r){t[e++]=255&r,t[e++]=r>>>8&255,t[e++]=r>>>16&255,t[e++]=r>>>24&255},t._blobToBinary=function(t){for(var e="",r=t.length,s=0;s<r;s++)e+=String.fromCharCode(t[s]);return e},t.GDI={METAHEADER_SIZE:18,BITMAPINFOHEADER_SIZE:40,BITMAPCOREHEADER_SIZE:12,MetafileType:{MEMORYMETAFILE:1,DISKMETAFILE:2},MetafileVersion:{METAVERSION100:256,METAVERSION300:768},RecordType:{META_EOF:0,META_REALIZEPALETTE:53,META_SETPALENTRIES:55,META_SETBKMODE:258,META_SETMAPMODE:259,META_SETROP2:260,META_SETRELABS:261,META_SETPOLYFILLMODE:262,META_SETSTRETCHBLTMODE:263,META_SETTEXTCHAREXTRA:264,META_RESTOREDC:295,META_RESIZEPALETTE:313,META_DIBCREATEPATTERNBRUSH:322,META_SETLAYOUT:329,META_SETBKCOLOR:513,META_SETTEXTCOLOR:521,META_OFFSETVIEWPORTORG:529,META_LINETO:531,META_MOVETO:532,META_OFFSETCLIPRGN:544,META_FILLREGION:552,META_SETMAPPERFLAGS:561,META_SELECTPALETTE:564,META_POLYGON:804,META_POLYLINE:805,META_SETTEXTJUSTIFICATION:522,META_SETWINDOWORG:523,META_SETWINDOWEXT:524,META_SETVIEWPORTORG:525,META_SETVIEWPORTEXT:526,META_OFFSETWINDOWORG:527,META_SCALEWINDOWEXT:1040,META_SCALEVIEWPORTEXT:1042,META_EXCLUDECLIPRECT:1045,META_INTERSECTCLIPRECT:1046,META_ELLIPSE:1048,META_FLOODFILL:1049,META_FRAMEREGION:1065,META_ANIMATEPALETTE:1078,META_TEXTOUT:1313,META_POLYPOLYGON:1336,META_EXTFLOODFILL:1352,META_RECTANGLE:1051,META_SETPIXEL:1055,META_ROUNDRECT:1564,META_PATBLT:1565,META_SAVEDC:30,META_PIE:2074,META_STRETCHBLT:2851,META_ESCAPE:1574,META_INVERTREGION:298,META_PAINTREGION:299,META_SELECTCLIPREGION:300,META_SELECTOBJECT:301,META_SETTEXTALIGN:302,META_ARC:2071,META_CHORD:2096,META_BITBLT:2338,META_EXTTEXTOUT:2610,META_SETDIBTODEV:3379,META_DIBBITBLT:2368,META_DIBSTRETCHBLT:2881,META_STRETCHDIB:3907,META_DELETEOBJECT:496,META_CREATEPALETTE:247,META_CREATEPATTERNBRUSH:505,META_CREATEPENINDIRECT:762,META_CREATEFONTINDIRECT:763,META_CREATEBRUSHINDIRECT:764,META_CREATEREGION:1791},MetafileEscapes:{NEWFRAME:1,ABORTDOC:2,NEXTBAND:3,SETCOLORTABLE:4,GETCOLORTABLE:5,FLUSHOUT:6,DRAFTMODE:7,QUERYESCSUPPORT:8,SETABORTPROC:9,STARTDOC:10,ENDDOC:11,GETPHYSPAGESIZE:12,GETPRINTINGOFFSET:13,GETSCALINGFACTOR:14,META_ESCAPE_ENHANCED_METAFILE:15,SETPENWIDTH:16,SETCOPYCOUNT:17,SETPAPERSOURCE:18,PASSTHROUGH:19,GETTECHNOLOGY:20,SETLINECAP:21,SETLINEJOIN:22,SETMITERLIMIT:23,BANDINFO:24,DRAWPATTERNRECT:25,GETVECTORPENSIZE:26,GETVECTORBRUSHSIZE:27,ENABLEDUPLEX:28,GETSETPAPERBINS:29,GETSETPRINTORIENT:30,ENUMPAPERBINS:31,SETDIBSCALING:32,EPSPRINTING:33,ENUMPAPERMETRICS:34,GETSETPAPERMETRICS:35,POSTSCRIPT_DATA:37,POSTSCRIPT_IGNORE:38,GETDEVICEUNITS:42,GETEXTENDEDTEXTMETRICS:256,GETPAIRKERNTABLE:258,EXTTEXTOUT:512,GETFACENAME:513,DOWNLOADFACE:514,METAFILE_DRIVER:2049,QUERYDIBSUPPORT:3073,BEGIN_PATH:4096,CLIP_TO_PATH:4097,END_PATH:4098,OPEN_CHANNEL:4110,DOWNLOADHEADER:4111,CLOSE_CHANNEL:4112,POSTSCRIPT_PASSTHROUGH:4115,ENCAPSULATED_POSTSCRIPT:4116,POSTSCRIPT_IDENTIFY:4117,POSTSCRIPT_INJECTION:4118,CHECKJPEGFORMAT:4119,CHECKPNGFORMAT:4120,GET_PS_FEATURESETTING:4121,MXDC_ESCAPE:4122,SPCLPASSTHROUGH2:4568},MapMode:{MM_TEXT:1,MM_LOMETRIC:2,MM_HIMETRIC:3,MM_LOENGLISH:4,MM_HIENGLISH:5,MM_TWIPS:6,MM_ISOTROPIC:7,MM_ANISOTROPIC:8},StretchMode:{BLACKONWHITE:1,WHITEONBLACK:2,COLORONCOLOR:3,HALFTONE:4},TextAlignmentMode:{TA_UPDATECP:1,TA_RIGHT:2,TA_CENTER:6,TA_BOTTOM:8,TA_BASELINE:24,TA_RTLREADING:256},MixMode:{TRANSPARENT:1,OPAQUE:2},VerticalTextAlignmentMode:{VTA_BOTTOM:2,VTA_CENTER:6,VTA_LEFT:8,VTA_BASELINE:24},BrushStyle:{BS_SOLID:0,BS_NULL:1,BS_HATCHED:2,BS_PATTERN:3,BS_INDEXED:4,BS_DIBPATTERN:5,BS_DIBPATTERNPT:6,BS_PATTERN8X8:7,BS_DIBPATTERN8X8:8,BS_MONOPATTERN:9},PenStyle:{PS_SOLID:0,PS_DASH:1,PS_DOT:2,PS_DASHDOT:3,PS_DASHDOTDOT:4,PS_NULL:5,PS_INSIDEFRAME:6,PS_USERSTYLE:7,PS_ALTERNATE:8,PS_ENDCAP_SQUARE:256,PS_ENDCAP_FLAT:512,PS_JOIN_BEVEL:4096,PS_JOIN_MITER:8192},PolyFillMode:{ALTERNATE:1,WINDING:2},ColorUsage:{DIB_RGB_COLORS:0,DIB_PAL_COLORS:1,DIB_PAL_INDICES:2},PaletteEntryFlag:{PC_RESERVED:1,PC_EXPLICIT:2,PC_NOCOLLAPSE:4},BitmapCompression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5}},t._uniqueId=0,t}()},"./src/wmfjs/Primitives.ts":/*!*********************************!*\
  !*** ./src/wmfjs/Primitives.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{Obj:()=>n,PointS:()=>i,Rect:()=>o});var s=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),i=function(){function t(t,e,r){null!=t?(this.x=t.readInt16(),this.y=t.readInt16()):(this.x=e,this.y=r)}return t.prototype.clone=function(){return new t(null,this.x,this.y)},t.prototype.toString=function(){return"{x: "+this.x+", y: "+this.y+"}"},t}(),o=function(){function t(t,e,r,s,i){null!=t?(this.bottom=t.readInt16(),this.right=t.readInt16(),this.top=t.readInt16(),this.left=t.readInt16()):(this.bottom=i,this.right=s,this.top=r,this.left=e)}return t.prototype.clone=function(){return new t(null,this.left,this.top,this.right,this.bottom)},t.prototype.toString=function(){return"{left: "+this.left+", top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+"}"},t.prototype.empty=function(){return this.left>=this.right||this.top>=this.bottom},t.prototype.intersect=function(e){return this.empty()||e.empty()||this.left>=e.right||this.top>=e.bottom||this.right<=e.left||this.bottom<=e.top?null:new t(null,Math.max(this.left,e.left),Math.max(this.top,e.top),Math.min(this.right,e.right),Math.min(this.bottom,e.bottom))},t}(),n=function(){function t(t){this.type=t}return t.prototype.clone=function(){throw new s.WMFJSError("clone not implemented")},t.prototype.toString=function(){throw new s.WMFJSError("toString not implemented")},t}()},"./src/wmfjs/Region.ts":/*!*****************************!*\
  !*** ./src/wmfjs/Region.ts ***!
  \*****************************/(t,e,r)=>{r.r(e),r.d(e,{CreateSimpleRegion:()=>a,Region:()=>l,Scan:()=>h});var s,i=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),o=r(/*! ./Primitives */"./src/wmfjs/Primitives.ts"),n=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),l=function(t){function e(e,r){var s=t.call(this,"region")||this;if(null!=e){if(e.skip(2),6!==e.readInt16())throw new i.WMFJSError("Invalid region identifier");e.skip(2),e.readInt16();var n=e.readInt16();e.skip(2);var l=e.readInt16(),a=e.readInt16(),p=e.readInt16(),c=e.readInt16();s.bounds=new o.Rect(null,l,a,p,c),s.scans=[];for(var u=0;u<n;u++)s.scans.push(new h(e));s._updateComplexity()}else if(null!=r){if(s.bounds=null!=r.bounds?r.bounds.clone():null,null!=r.scans){s.scans=[];for(var u=0;u<r.scans.length;u++)s.scans.push(r.scans[u].clone())}else s.scans=null;s.complexity=r.complexity}else s.bounds=null,s.scans=null,s.complexity=0;return s}return n(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return"{complexity: "+["null","simple","complex"][this.complexity]+" bounds: "+(null!=this.bounds?this.bounds.toString():"[none]")+" #scans: "+(null!=this.scans?this.scans.length:"[none]")+"}"},e.prototype._updateComplexity=function(){if(null==this.bounds)this.complexity=0,this.scans=null;else if(this.bounds.empty())this.complexity=0,this.scans=null,this.bounds=null;else if(null==this.scans)this.complexity=1;else if(this.complexity=2,1===this.scans.length){var t=this.scans[0];if(t.top===this.bounds.top&&t.bottom===this.bounds.bottom&&1===t.scanlines.length){var e=t.scanlines[0];e.left===this.bounds.left&&e.right===this.bounds.right&&(this.scans=null,this.complexity=1)}}},e.prototype.subtract=function(t){if(i.Helper.log("[wmf] Region "+this.toString()+" subtract "+t.toString()),null!=this.bounds&&null!=this.bounds.intersect(t)){null==this.scans&&(this.scans=[],this.scans.push(new h(null,null,this.bounds.top,this.bounds.bottom,[{left:this.bounds.left,right:this.bounds.right}])),this.complexity=2);for(var e=0;e<this.scans.length;){var r=this.scans[e];if(r.bottom>=t.top){var s=r.clone();r.bottom=t.top-1,s.top=t.top,r.top>=r.bottom?this.scans[e]=s:(i.Helper.log("[wmf] Region split top scan "+e+" for substraction"),this.scans.splice(++e,0,s));break}e++}for(var n=e;e<this.scans.length;){var r=this.scans[e];if(r.top>t.bottom)break;if(r.bottom>t.bottom){var s=r.clone();r.bottom=t.bottom,s.top=t.bottom+1,r.top>=r.bottom?this.scans[e]=s:(i.Helper.log("[wmf] Region split bottom scan "+e+" for substraction"),this.scans.splice(++e,0,s));break}e++}if(n<this.scans.length){var l=e;for(e=n;e<l;){var r=this.scans[e];if(!r.subtract(t.left,t.right)){i.Helper.log("[wmf] Region remove now empty scan "+e+" due to subtraction"),this.scans.splice(e,1),l--;continue}e++}}if(null!=this.scans){for(var a,p=void 0,c=void 0,u=void 0,d=this.scans.length,E=0;E<d;E++){var r=this.scans[E];0===E&&(a=r.top),E===d-1&&(u=r.bottom);var f=r.scanlines.length;if(f>0){var T=r.scanlines[0];(null==p||T.left<p)&&(p=T.left),T=r.scanlines[f-1],(null==c||T.right>c)&&(c=T.right)}}null!=p&&null!=a&&null!=c&&null!=u?(this.bounds=new o.Rect(null,p,a,c,u),this._updateComplexity()):(this.bounds=null,this.scans=null,this.complexity=0)}else this._updateComplexity()}i.Helper.log("[wmf] Region subtraction -> "+this.toString())},e.prototype.intersect=function(t){if(i.Helper.log("[wmf] Region "+this.toString()+" intersect with "+t.toString()),null!=this.bounds){if(this.bounds=this.bounds.intersect(t),null!=this.bounds){if(null!=this.scans){for(var e=0;e<this.scans.length;){var r=this.scans[e];if(r.bottom<this.bounds.top)e++;else break}for(e>0&&(i.Helper.log("[wmf] Region remove "+e+" scans from top"),this.scans.splice(0,e),this.scans.length>0&&(this.scans[0].top=this.bounds.top)),e=0;e<this.scans.length;){var r=this.scans[e];if(r.top>this.bounds.bottom){i.Helper.log("[wmf] Region remove "+(this.scans.length-e)+" scans from bottom"),this.scans.splice(e,this.scans.length-e);break}if(!r.intersect(this.bounds.left,this.bounds.right)){i.Helper.log("[wmf] Region remove now empty scan "+e+" due to intersection"),this.scans.splice(e,1);continue}e++}this.scans.length>0&&(this.scans[this.scans.length-1].bottom=this.bounds.bottom),this._updateComplexity()}}else this.scans=null,this.complexity=0}i.Helper.log("[wmf] Region intersection -> "+this.toString())},e.prototype.offset=function(t,e){if(null!=this.bounds&&(this.bounds.left+=t,this.bounds.top+=e,this.bounds.right+=t,this.bounds.bottom+=e),null!=this.scans)for(var r=this.scans.length,s=0;s<r;s++){var i=this.scans[s];i.top+=e,i.bottom+=e;for(var o=i.scanlines.length,n=0;n<o;n++){var l=i.scanlines[n];l.left+=t,l.right+=t}}},e}(o.Obj);function a(t,e,r,s){var i=new l(null,null);return i.bounds=new o.Rect(null,t,e,r,s),i._updateComplexity(),i}var h=function(){function t(t,e,r,s,i){if(null!=t){var o=t.readUint16();this.top=t.readUint16(),this.bottom=t.readUint16(),this.scanlines=[];for(var n=0;n<o;n++){var l=t.readUint16(),a=t.readUint16();this.scanlines.push({left:l,right:a})}t.skip(2)}else if(null!=e){this.top=e.top,this.bottom=e.bottom,this.scanlines=[];for(var n=0;n<e.scanlines.length;n++){var h=e.scanlines[n];this.scanlines.push({left:h.left,right:h.right})}}else this.top=r,this.bottom=s,this.scanlines=i}return t.prototype.clone=function(){return new t(null,this)},t.prototype.subtract=function(t,e){for(r=0;r<this.scanlines.length;){var r,s=this.scanlines[r];if(s.left<=t){if(s.right>=t&&(s.right=t-1,s.left>=s.right)){this.scanlines.splice(r,1);continue}r++}else break}for(var i=r,o=0;r<this.scanlines.length;){var s=this.scanlines[r];if(s.right>e){s.left=e,o=r-i,s.left>=s.right&&o++;break}r++}return o>0&&i<this.scanlines.length&&this.scanlines.splice(i,o),this.scanlines.length>0},t.prototype.intersect=function(t,e){for(var r=0;r<this.scanlines.length;r++){var s=this.scanlines[r];if(s.left>=t||s.right>=t){r>0&&this.scanlines.splice(0,r);break}}if(this.scanlines.length>0){var s=this.scanlines[0];s.left<t&&(s.left=t);for(var r=0;r<this.scanlines.length;r++)if((s=this.scanlines[r]).left>e){this.scanlines.splice(r,this.scanlines.length-r);break}this.scanlines.length>0&&(s=this.scanlines[this.scanlines.length-1]).right>e&&(s.right=e)}return this.scanlines.length>0},t.prototype.toString=function(){return"{ #scanlines: "+this.scanlines.length+"}"},t}()},"./src/wmfjs/Renderer.ts":/*!*******************************!*\
  !*** ./src/wmfjs/Renderer.ts ***!
  \*******************************/(t,e,r)=>{r.r(e),r.d(e,{Renderer:()=>a});var s=r(/*! ../util */"./src/util/index.ts"),i=r(/*! ./Blob */"./src/wmfjs/Blob.ts"),o=r(/*! ./GDIContext */"./src/wmfjs/GDIContext.ts"),n=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),l=r(/*! ./WMFRecords */"./src/wmfjs/WMFRecords.ts"),a=function(){function t(t){this.parse(t),n.Helper.log("WMFJS.Renderer instantiated")}return t.prototype.render=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");return this._render(new s.SVG(e),t.mapMode,t.xExt,t.yExt),e.setAttribute("viewBox",[0,0,t.xExt,t.yExt].join(" ")),e.setAttribute("preserveAspectRatio","none"),e.setAttribute("width",t.width),e.setAttribute("height",t.height),e},t.prototype.parse=function(t){this._img=null;var e,r,s,o,l=new i.Blob(t),a=l.readUint32();switch(2596720087===a?(s=new p(l),o=l.pos,e=l.readUint16(),r=l.readUint16()):(o=0,e=65535&a,r=a>>>16&65535),e){case n.Helper.GDI.MetafileType.MEMORYMETAFILE:case n.Helper.GDI.MetafileType.DISKMETAFILE:if(r===n.Helper.GDI.METAHEADER_SIZE/2){var h=l.readUint16();switch(h){case n.Helper.GDI.MetafileVersion.METAVERSION100:case n.Helper.GDI.MetafileVersion.METAVERSION300:this._img=new c(l,s,h,o+2*r)}}}if(null==this._img)throw new n.WMFJSError("Format not recognized")},t.prototype._render=function(t,e,r,s){var i=new o.GDIContext(t);i.setViewportExt(r,s),i.setMapMode(e),n.Helper.log("[WMF] BEGIN RENDERING --->"),this._img.render(i),n.Helper.log("[WMF] <--- DONE RENDERING")},t}(),h=function(){function t(t){this.left=t.readInt16(),this.top=t.readInt16(),this.right=t.readInt16(),this.bottom=t.readInt16()}return t.prototype.toString=function(){return"{left: "+this.left+", top: "+this.top+", right: "+this.right+", bottom: "+this.bottom+"}"},t}(),p=function(t){t.skip(2),this.boundingBox=new h(t),this.unitsPerInch=t.readInt16(),t.skip(4),t.skip(2),n.Helper.log("Got bounding box "+this.boundingBox+" and "+this.unitsPerInch+" units/inch")},c=function(){function t(t,e,r,s){this._version=r,this._hdrsize=s,this._placable=e,this._records=new l.WMFRecords(t,this._hdrsize)}return t.prototype.render=function(t){this._records.play(t)},t}()},"./src/wmfjs/Style.ts":/*!****************************!*\
  !*** ./src/wmfjs/Style.ts ***!
  \****************************/(t,e,r)=>{r.r(e),r.d(e,{Brush:()=>p,ColorRef:()=>a,Font:()=>h,Palette:()=>d,PaletteEntry:()=>u,Pen:()=>c});var s,i=r(/*! ./Bitmap */"./src/wmfjs/Bitmap.ts"),o=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),n=r(/*! ./Primitives */"./src/wmfjs/Primitives.ts"),l=(s=function(t,e){return(s=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(){function t(t,e,r,s){null!=t?(this.r=t.readUint8(),this.g=t.readUint8(),this.b=t.readUint8(),t.skip(1)):(this.r=e,this.g=r,this.b=s)}return t.prototype.clone=function(){return new t(null,this.r,this.g,this.b)},t.prototype.toHex=function(){return(16777216+(this.r<<16|this.g<<8|this.b)).toString(16).slice(1)},t.prototype.toString=function(){return"{r: "+this.r+", g: "+this.g+", b: "+this.b+"}"},t}(),h=function(t){function e(e,r){var s=t.call(this,"font")||this;if(null!=e){s.height=e.readInt16(),s.width=e.readInt16(),s.escapement=e.readInt16(),s.orientation=e.readInt16(),s.weight=e.readInt16(),s.italic=e.readUint8(),s.underline=e.readUint8(),s.strikeout=e.readUint8(),s.charset=e.readUint8(),s.outprecision=e.readUint8(),s.clipprecision=e.readUint8(),s.quality=e.readUint8();var i=e.readUint8();s.pitch=15&i,s.family=i>>6&3;var o=e.pos;s.facename=e.readNullTermString(Math.min(r-(e.pos-o),32))}else null!=r?(s.height=r.height,s.width=r.width,s.escapement=r.escapement,s.orientation=r.orientation,s.weight=r.weight,s.italic=r.italic,s.underline=r.underline,s.strikeout=r.strikeout,s.charset=r.charset,s.outprecision=r.outprecision,s.clipprecision=r.clipprecision,s.quality=r.quality,s.pitch=r.pitch,s.family=r.family,s.facename=r.facename):(s.height=-80,s.width=0,s.escapement=0,s.orientation=0,s.weight=400,s.italic=0,s.underline=0,s.strikeout=0,s.charset=0,s.outprecision=0,s.clipprecision=0,s.quality=0,s.pitch=0,s.family=0,s.facename="Helvetica");return s}return l(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return JSON.stringify(this)},e}(n.Obj),p=function(t){function e(e,r,s){var n=t.call(this,"brush")||this;if(null!=e){var l=e.pos;if(!0===s||!1===s)switch(n.style=e.readUint16(),s&&n.style!==o.Helper.GDI.BrushStyle.BS_PATTERN&&(n.style=o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT),n.style){case o.Helper.GDI.BrushStyle.BS_SOLID:n.color=new a(e);break;case o.Helper.GDI.BrushStyle.BS_PATTERN:e.skip(s?2:6),n.pattern=new i.Bitmap16(e,r-(e.pos-l));break;case o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:n.colorusage=s?e.readUint16():e.readUint32(),s||e.skip(2),n.dibpatternpt=new i.DIBitmap(e,r-(e.pos-l));break;case o.Helper.GDI.BrushStyle.BS_HATCHED:n.color=new a(e),n.hatchstyle=e.readUint16()}else s instanceof i.PatternBitmap16&&(n.style=o.Helper.GDI.BrushStyle.BS_PATTERN,n.pattern=s)}else if(null!=r)switch(n.style=r.style,n.style){case o.Helper.GDI.BrushStyle.BS_SOLID:n.color=r.color.clone();break;case o.Helper.GDI.BrushStyle.BS_PATTERN:n.pattern=r.pattern.clone();break;case o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:n.colorusage=r.colorusage,n.dibpatternpt=r.dibpatternpt;break;case o.Helper.GDI.BrushStyle.BS_HATCHED:n.color=r.color.clone(),n.hatchstyle=r.hatchstyle}return n}return l(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){var t="{style: "+this.style;switch(this.style){case o.Helper.GDI.BrushStyle.BS_SOLID:t+=", color: "+this.color.toString();break;case o.Helper.GDI.BrushStyle.BS_DIBPATTERNPT:t+=", colorusage: "+this.colorusage;break;case o.Helper.GDI.BrushStyle.BS_HATCHED:t+=", color: "+this.color.toString()+", hatchstyle: "+this.hatchstyle}return t+"}"},e}(n.Obj),c=function(t){function e(e,r,s,i,l,h){var p=t.call(this,"pen")||this;return null!=e?(r=e.readUint16(),p.style=255&r,p.width=new n.PointS(e),p.color=new a(e),p.linecap=r&(o.Helper.GDI.PenStyle.PS_ENDCAP_SQUARE|o.Helper.GDI.PenStyle.PS_ENDCAP_FLAT),p.join=r&(o.Helper.GDI.PenStyle.PS_JOIN_BEVEL|o.Helper.GDI.PenStyle.PS_JOIN_MITER)):(p.style=r,p.width=s,p.color=i,p.linecap=l,p.join=h),p}return l(e,t),e.prototype.clone=function(){return new e(null,this.style,this.width.clone(),this.color.clone(),this.linecap,this.join)},e.prototype.toString=function(){return"{style: "+this.style+", width: "+this.width.toString()+", color: "+this.color.toString()+", linecap: "+this.linecap+", join: "+this.join+"}"},e}(n.Obj),u=function(){function t(t,e){null!=t?(this.flag=t.readUint8(),this.b=t.readUint8(),this.g=t.readUint8(),this.r=t.readUint8()):(this.flag=e.flag,this.b=e.b,this.g=e.g,this.r=e.r)}return t.prototype.clone=function(){return new t(null,this)},t}(),d=function(t){function e(e,r){var s=t.call(this,"palette")||this;if(null!=e){s.start=e.readUint16();var i=e.readUint16();for(s.entries=[];i>0;)s.entries.push(new u(e)),i--}else{s.start=r.start,s.entries=[];for(var o=r.entries.length,n=0;n<o;n++)s.entries.push(r.entries[n])}return s}return l(e,t),e.prototype.clone=function(){return new e(null,this)},e.prototype.toString=function(){return"{ #entries: "+this.entries.length+"}"},e}(n.Obj)},"./src/wmfjs/WMFRecords.ts":/*!*********************************!*\
  !*** ./src/wmfjs/WMFRecords.ts ***!
  \*********************************/(t,e,r)=>{r.r(e),r.d(e,{WMFRecords:()=>h});var s=r(/*! ./Bitmap */"./src/wmfjs/Bitmap.ts"),i=r(/*! ./Blob */"./src/wmfjs/Blob.ts"),o=r(/*! ./Helper */"./src/wmfjs/Helper.ts"),n=r(/*! ./Primitives */"./src/wmfjs/Primitives.ts"),l=r(/*! ./Region */"./src/wmfjs/Region.ts"),a=r(/*! ./Style */"./src/wmfjs/Style.ts"),h=function(){function t(t,e){this._records=[];for(var r=!1,h=e,p=this;!r&&"break-main_loop"!==function(){t.seek(h);var e=t.readUint32();if(e<3)throw new o.WMFJSError("Invalid record size");var c=t.readUint16();switch(c){case o.Helper.GDI.RecordType.META_EOF:return r=!0,"break-main_loop";case o.Helper.GDI.RecordType.META_SETMAPMODE:var u=t.readUint16();p._records.push(function(t){t.setMapMode(u)});break;case o.Helper.GDI.RecordType.META_SETWINDOWORG:var d=t.readInt16(),E=t.readInt16();p._records.push(function(t){t.setWindowOrg(E,d)});break;case o.Helper.GDI.RecordType.META_SETWINDOWEXT:var f=t.readInt16(),T=t.readInt16();p._records.push(function(t){t.setWindowExt(T,f)});break;case o.Helper.GDI.RecordType.META_OFFSETWINDOWORG:var g=t.readInt16(),_=t.readInt16();p._records.push(function(t){t.offsetWindowOrg(_,g)});break;case o.Helper.GDI.RecordType.META_SETVIEWPORTORG:var R=t.readInt16(),S=t.readInt16();p._records.push(function(t){t.setViewportOrg(S,R)});break;case o.Helper.GDI.RecordType.META_SETVIEWPORTEXT:var y=t.readInt16(),I=t.readInt16();p._records.push(function(t){t.setViewportExt(I,y)});break;case o.Helper.GDI.RecordType.META_OFFSETVIEWPORTORG:var v=t.readInt16(),b=t.readInt16();p._records.push(function(t){t.offsetViewportOrg(b,v)});break;case o.Helper.GDI.RecordType.META_SAVEDC:p._records.push(function(t){t.saveDC()});break;case o.Helper.GDI.RecordType.META_RESTOREDC:var A=t.readInt16();p._records.push(function(t){t.restoreDC(A)});break;case o.Helper.GDI.RecordType.META_SETSTRETCHBLTMODE:var w=t.readUint16();p._records.push(function(t){t.setStretchBltMode(w)});break;case o.Helper.GDI.RecordType.META_DIBBITBLT:var M=(c>>8)+3!==e,O=t.readUint16()|t.readUint16()<<16,P=t.readInt16(),D=t.readInt16();M||t.skip(2);var H=t.readInt16(),m=t.readInt16(),C=t.readInt16(),L=t.readInt16();if(M){var G=2*e-(t.pos-h),N=new s.DIBitmap(t,G);p._records.push(function(t){t.dibBits(D,P,L,C,m,H,O,N)})}break;case o.Helper.GDI.RecordType.META_DIBSTRETCHBLT:var M=(c>>8)+3!==e,x=t.readUint16()|t.readUint16()<<16,B=t.readInt16(),U=t.readInt16(),k=t.readInt16(),F=t.readInt16(),j=t.readInt16(),X=t.readInt16(),W=t.readInt16(),Y=t.readInt16(),G=2*e-(t.pos-h),V=new s.DIBitmap(t,G);p._records.push(function(t){t.stretchDibBits(F,k,U,B,Y,W,X,j,x,V)});break;case o.Helper.GDI.RecordType.META_STRETCHDIB:var J=t.readUint16()|t.readUint16()<<16,z=t.readInt16(),Z=t.readInt16(),K=t.readInt16(),q=t.readInt16(),Q=t.readInt16(),$=t.readInt16(),tt=t.readInt16(),te=t.readInt16(),tr=t.readInt16(),G=2*e-(t.pos-h),ts=new s.DIBitmap(t,G);p._records.push(function(t){t.stretchDib(Q,q,K,Z,tr,te,tt,$,J,z,ts)});break;case o.Helper.GDI.RecordType.META_ESCAPE:var ti=t.readUint16(),to=t.readUint16(),tn=t.pos,tl=new i.Blob(t,tn);p._records.push(function(t){t.escape(ti,tl,tn,to)});break;case o.Helper.GDI.RecordType.META_SETTEXTALIGN:var ta=t.readUint16();p._records.push(function(t){t.setTextAlign(ta)});break;case o.Helper.GDI.RecordType.META_SETBKMODE:var th=t.readUint16();p._records.push(function(t){t.setBkMode(th)});break;case o.Helper.GDI.RecordType.META_SETTEXTCOLOR:var tp=new a.ColorRef(t);p._records.push(function(t){t.setTextColor(tp)});break;case o.Helper.GDI.RecordType.META_SETBKCOLOR:var tc=new a.ColorRef(t);p._records.push(function(t){t.setBkColor(tc)});break;case o.Helper.GDI.RecordType.META_CREATEBRUSHINDIRECT:var G=2*e-(t.pos-h),tu=new a.Brush(t,G,!1);p._records.push(function(t){t.createBrush(tu)});break;case o.Helper.GDI.RecordType.META_DIBCREATEPATTERNBRUSH:var G=2*e-(t.pos-h),td=new a.Brush(t,G,!0);p._records.push(function(t){t.createBrush(td)});break;case o.Helper.GDI.RecordType.META_CREATEPENINDIRECT:var tE=new a.Pen(t);p._records.push(function(t){t.createPen(tE)});break;case o.Helper.GDI.RecordType.META_CREATEFONTINDIRECT:var G=2*e-(t.pos-h),tf=new a.Font(t,G);p._records.push(function(t){t.createFont(tf)});break;case o.Helper.GDI.RecordType.META_SELECTOBJECT:var tT=t.readUint16();p._records.push(function(t){t.selectObject(tT,null)});break;case o.Helper.GDI.RecordType.META_SELECTPALETTE:var tg=t.readUint16();p._records.push(function(t){t.selectObject(tg,"palette")});break;case o.Helper.GDI.RecordType.META_SELECTCLIPREGION:var t_=t.readUint16();p._records.push(function(t){t.selectObject(t_,"region")});break;case o.Helper.GDI.RecordType.META_DELETEOBJECT:var tR=t.readUint16();p._records.push(function(t){t.deleteObject(tR)});break;case o.Helper.GDI.RecordType.META_RECTANGLE:var tS=new n.Rect(t);p._records.push(function(t){t.rectangle(tS,0,0)});break;case o.Helper.GDI.RecordType.META_ROUNDRECT:var ty=t.readInt16(),tI=t.readInt16(),tv=new n.Rect(t);p._records.push(function(t){t.rectangle(tv,tI,ty)});break;case o.Helper.GDI.RecordType.META_LINETO:var tb=t.readInt16(),tA=t.readInt16();p._records.push(function(t){t.lineTo(tA,tb)});break;case o.Helper.GDI.RecordType.META_MOVETO:var tw=t.readInt16(),tM=t.readInt16();p._records.push(function(t){t.moveTo(tM,tw)});break;case o.Helper.GDI.RecordType.META_TEXTOUT:var tO=t.readInt16();if(tO>0){var tP=t.readString(tO);t.skip(tO%2);var tD=t.readInt16(),tH=t.readInt16();p._records.push(function(t){t.textOut(tH,tD,tP)})}break;case o.Helper.GDI.RecordType.META_EXTTEXTOUT:var tm=t.readInt16(),tC=t.readInt16(),tO=t.readInt16(),tL=t.readUint16(),tG=null,tN=null;2*e===14+tO+tO%2&&(tG=!1,tN=!1),2*e===22+tO+tO%2&&(tG=!0,tN=!1),2*e===14+tO+tO%2+2*tO&&(tG=!1,tN=!0),2*e===22+tO+tO%2+2*tO&&(tG=!0,tN=!0);var tx=tG?new n.Rect(t):null;if(tO>0){var tB=t.readString(tO);t.skip(tO%2);var tU=[];if(tN)for(var tk=0;tk<tB.length;tk++)tU.push(t.readInt16());p._records.push(function(t){t.extTextOut(tC,tm,tB,tL,tx,tU)})}break;case o.Helper.GDI.RecordType.META_EXCLUDECLIPRECT:var tF=new n.Rect(t);p._records.push(function(t){t.excludeClipRect(tF)});break;case o.Helper.GDI.RecordType.META_INTERSECTCLIPRECT:var tj=new n.Rect(t);p._records.push(function(t){t.intersectClipRect(tj)});break;case o.Helper.GDI.RecordType.META_POLYGON:for(var tX=t.readInt16(),tW=[];tX>0;)tW.push(new n.PointS(t)),tX--;p._records.push(function(t){t.polygon(tW,!0)});break;case o.Helper.GDI.RecordType.META_SETPOLYFILLMODE:var tY=t.readUint16();p._records.push(function(t){t.setPolyFillMode(tY)});break;case o.Helper.GDI.RecordType.META_POLYPOLYGON:for(var tX=t.readUint16(),tV=[],tk=0;tk<tX;tk++)tV.push(t.readUint16());for(var tJ=[],tk=0;tk<tX;tk++){for(var tz=tV[tk],tZ=[],tK=0;tK<tz;tK++)tZ.push(new n.PointS(t));tJ.push(tZ)}p._records.push(function(t){t.polyPolygon(tJ)});break;case o.Helper.GDI.RecordType.META_POLYLINE:for(var tX=t.readInt16(),tq=[];tX>0;)tq.push(new n.PointS(t)),tX--;p._records.push(function(t){t.polyline(tq)});break;case o.Helper.GDI.RecordType.META_ELLIPSE:var tQ=new n.Rect(t);p._records.push(function(t){t.ellipse(tQ)});break;case o.Helper.GDI.RecordType.META_CREATEPALETTE:var t$=new a.Palette(t);p._records.push(function(t){t.createPalette(t$)});break;case o.Helper.GDI.RecordType.META_CREATEREGION:var t0=new l.Region(t);p._records.push(function(t){t.createRegion(t0)});break;case o.Helper.GDI.RecordType.META_CREATEPATTERNBRUSH:var G=2*e-(t.pos-h),t1=new s.PatternBitmap16(t,G),t2=new a.Brush(t,G,t1);p._records.push(function(t){t.createPatternBrush(t2)});break;case o.Helper.GDI.RecordType.META_OFFSETCLIPRGN:var t6=t.readInt16(),t3=t.readInt16();p._records.push(function(t){t.offsetClipRgn(t3,t6)});break;case o.Helper.GDI.RecordType.META_REALIZEPALETTE:case o.Helper.GDI.RecordType.META_SETPALENTRIES:case o.Helper.GDI.RecordType.META_SETROP2:case o.Helper.GDI.RecordType.META_SETRELABS:case o.Helper.GDI.RecordType.META_SETTEXTCHAREXTRA:case o.Helper.GDI.RecordType.META_RESIZEPALETTE:case o.Helper.GDI.RecordType.META_SETLAYOUT:case o.Helper.GDI.RecordType.META_FILLREGION:case o.Helper.GDI.RecordType.META_SETMAPPERFLAGS:case o.Helper.GDI.RecordType.META_SETTEXTJUSTIFICATION:case o.Helper.GDI.RecordType.META_SCALEWINDOWEXT:case o.Helper.GDI.RecordType.META_SCALEVIEWPORTEXT:case o.Helper.GDI.RecordType.META_FLOODFILL:case o.Helper.GDI.RecordType.META_FRAMEREGION:case o.Helper.GDI.RecordType.META_ANIMATEPALETTE:case o.Helper.GDI.RecordType.META_EXTFLOODFILL:case o.Helper.GDI.RecordType.META_SETPIXEL:case o.Helper.GDI.RecordType.META_PATBLT:case o.Helper.GDI.RecordType.META_PIE:case o.Helper.GDI.RecordType.META_STRETCHBLT:case o.Helper.GDI.RecordType.META_INVERTREGION:case o.Helper.GDI.RecordType.META_PAINTREGION:case o.Helper.GDI.RecordType.META_ARC:case o.Helper.GDI.RecordType.META_CHORD:case o.Helper.GDI.RecordType.META_BITBLT:case o.Helper.GDI.RecordType.META_SETDIBTODEV:default:var t4="UNKNOWN";for(var t5 in o.Helper.GDI.RecordType)if(o.Helper.GDI.RecordType[t5]===c){t4=t5;break}o.Helper.log("[WMF] "+t4+" record (0x"+c.toString(16)+") at offset 0x"+h.toString(16)+" with "+2*e+" bytes")}h+=2*e}(););if(!r)throw new o.WMFJSError("Could not read all records")}return t.prototype.play=function(t){for(var e=this._records.length,r=0;r<e;r++)this._records[r](t)},t}()}},s={};function i(t){var e=s[t];if(void 0!==e)return e.exports;var o=s[t]={exports:{}};return r[t](o,o.exports,i),o.exports}i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var o={};return(/*!****************************!*\
  !*** ./src/wmfjs/index.ts ***!
  \****************************/i.r(o),i.d(o,{Error:()=>e.WMFJSError,Renderer:()=>t.Renderer,loggingEnabled:()=>e.loggingEnabled}),t=i(/*! ./Renderer */"./src/wmfjs/Renderer.ts"),e=i(/*! ./Helper */"./src/wmfjs/Helper.ts"),o)})(),t.exports=e()},83131:function(t,e,r){"use strict";r.d(e,{RTFJS:function(){return s}});var s=r(40248);r(90170),r(57274)}}]);