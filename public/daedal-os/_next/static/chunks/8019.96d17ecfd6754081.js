"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8019],{8019:function(t,e,i){i.d(e,{$z:function(){return M},AY:function(){return w},CC:function(){return c},Iu:function(){return S},NN:function(){return p},RO:function(){return _},WZ:function(){return N},Z3:function(){return v},createM3uPlaylist:function(){return P},g:function(){return m},mW:function(){return O},ns:function(){return f},om:function(){return E},r$:function(){return I},tracksFromPlaylist:function(){return R},uG:function(){return D},vy:function(){return d}});var n=i(38365),r=i(97836),o=i(6484);let a=new Set(["Flexi - alien fish pond","Geiss - Spiral Artifact"]),l=`${r.Sd}/Documents/Winamp Skins`,s=["localhost",r.PACKAGE_DATA.author.url.replace("https://","")].includes(window.location.hostname),u=t=>`
  query {
    skins(filter: APPROVED, first: 1, offset: ${t}) {
      nodes {
        download_url
      }
    }
  }
`,d={availableSkins:[{name:"Aqua X",url:`${l}/Aqua_X.wsz`},{name:"Nucleo NLog v2G",url:`${l}/Nucleo_NLog_v102.wsz`},...s?[{defaultName:"Random (Winamp Skin Museum)",loading:!1,get name(){if(this.loading)return this.defaultName;return this.loading=!0,fetch("https://api.webamp.org/graphql",{body:JSON.stringify({query:u(Math.floor(1e3*Math.random()))}),headers:{"Content-Type":"application/json"},method:"POST"}).then(async t=>{var e,i,n;let{data:r}=await t.json()||{};this.skinUrl=null==r?void 0:null===(n=r.skins)||void 0===n?void 0:null===(i=n.nodes)||void 0===i?void 0:null===(e=i[0])||void 0===e?void 0:e.download_url,this.loading=!1}),this.defaultName},skinUrl:"",get url(){return this.skinUrl||`${l}/base-2.91.wsz`}}]:[],{name:"SpyAMP Professional Edition v5",url:`${l}/SpyAMP_Professional_Edition_v5.wsz`}]},h={height:116,width:275},p="#main-window",c="#playlist-window",m=(t,e="")=>t.skinIsLoaded().then(()=>{e&&(0,o.EK)(e)}),f=t=>t.store.dispatch({type:"CLOSE_WINDOW",windowId:"equalizer"}),v=t=>t.store.dispatch({open:!1,type:"ENABLE_MILKDROP"}),w=(t,e)=>t.store.dispatch({data:e,type:"SET_SKIN_DATA"}),g=(t,e)=>t.store.dispatch({butterchurn:e,type:"GOT_BUTTERCHURN"}),y=(t,e)=>t.store.dispatch({presets:e,type:"GOT_BUTTERCHURN_PRESETS"}),b=t=>{var e;let{presetHistory:i=[],presets:n=[]}=(null===(e=t.store.getState())||void 0===e?void 0:e.milkdrop)||{},r=Math.floor(Math.random()*n.length),o=n[r];return!o.name||a.has(o.name)||i.slice(-5).includes(r)?b(t):r},S=t=>{let e=b(t);t.store.dispatch({addToHistory:!0,index:e,type:"PRESET_REQUESTED"}),t.store.dispatch({index:e,type:"SELECT_PRESET_AT_INDEX"})},T=0,x=t=>{window.clearInterval(T),T=window.setInterval(()=>{t||window.clearInterval(T),S(t)},2e4)},E=t=>{let e=t.store.subscribe(()=>{var n,r;let{milkdrop:a,windows:l}=t.store.getState();(null==l?void 0:null===(r=l.genWindows)||void 0===r?void 0:null===(n=r.milkdrop)||void 0===n?void 0:n.open)&&!(null==a?void 0:a.butterchurn)&&(0,o.mb)(["/daedal-os/Program Files/Webamp/butterchurn.min.js"]).then(()=>{var n;if(!(null===(n=window.butterchurn)||void 0===n?void 0:n.default))return;g(t,window.butterchurn.default);let{playlist:r,main:o}=l.genWindows||{},{x:a=0,y:s=0}=((null==r?void 0:r.open)?null==r?void 0:r.position:null==o?void 0:o.position)||{};t.store.dispatch({positions:{milkdrop:{x:a,y:s+h.height}},type:"UPDATE_WINDOW_POSITIONS"}),e(),t.store.subscribe(()=>{let t=[...document.body.children].find(t=>{var e;return null===(e=t.classList)||void 0===e?void 0:e.contains("webamp-desktop")});if(t){let e=document.querySelector("main");e&&([...e.children].forEach(t=>{var e;(null===(e=t.classList)||void 0===e?void 0:e.contains("webamp-desktop"))&&t.remove()}),e.append(t))}}),i.e(9986,"high").then(i.t.bind(i,36607,23)).then(({default:e})=>{y(t,Object.entries(e).map(([t,e])=>({name:t,preset:e}))),S(t),x(t)})})})},_=()=>document.querySelector("#webamp"),N=(t,e)=>{let{height:i,width:r}=h,{x:o,y:a}=e||(0,n.Rf)({height:2*i,width:r});t.store.dispatch({positions:{main:{x:o,y:a},milkdrop:{x:0-r,y:0-i},playlist:{x:o,y:i+a}},type:"UPDATE_WINDOW_POSITIONS"})},D=(t,e)=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:e}),O=t=>t.store.dispatch({type:"SET_FOCUSED_WINDOW",window:""}),M=async(t,e)=>{let{parseBuffer:n}=await Promise.all([i.e(8090,"high"),i.e(2463,"high"),i.e(4726,"high")]).then(i.bind(i,52463)),{common:{album:a="",artist:l="",title:s=e},format:{duration:u=0}}=await n(t,{mimeType:r.BD,size:t.length},{duration:!0,skipCovers:!0,skipPostHeaders:!0});return{blob:(0,o.V4)(t,"audio/mpeg"),duration:Math.floor(u),metaData:{album:a,artist:l,title:s}}},P=t=>{let e=t.map(t=>{var e,i,n;let r=t.url?`
${t.url.toString()}`:"",o=t.defaultName;return(null===(e=t.metaData)||void 0===e?void 0:e.artist)?(null===(n=t.metaData)||void 0===n?void 0:n.title)?o=`${t.metaData.artist} - ${t.metaData.title}`:o&&(o=`${t.metaData.artist} - ${o}`):(null===(i=t.metaData)||void 0===i?void 0:i.title)&&(o=t.metaData.title),r?`#EXTINF:${t.duration??-1},${o||""}${r}`:""});return`${["#EXTM3U",...e.filter(Boolean)].join("\n")}
`},R=async(t,e,n)=>{var r;let{ASX:o,M3U:a,PLS:l}=await i.e(3454,"high").then(i.t.bind(i,63454,23));return((null===(r=({".asx":o,".m3u":a,".pls":l})[e])||void 0===r?void 0:r.parse(t).filter(Boolean).slice(0,1e3))??[]).map(({artist:t="",file:e="",length:i=0,title:r=""})=>{let[o,a]=[t.trim(),r.trim()];return{duration:i>0?i:0,metaData:{album:a||n,artist:o,title:a},url:e}})},$=(t="")=>t.replace(/<!\[CDATA\[|\]\]>/g,""),k={"somafm.com":t=>async()=>{var e,i;let{pathname:n}=new URL(t),[r]=n.replace("/","").split("-"),o=await (await fetch(`https://somafm.com/songs/${r}.xml`,{cache:"no-cache",credentials:"omit",keepalive:!1,mode:"cors",referrerPolicy:"no-referrer",window:null})).text(),a=new DOMParser().parseFromString(o,"application/xml").querySelector("song"),l=null==a?void 0:null===(e=a.querySelector("artist"))||void 0===e?void 0:e.innerHTML,s=null==a?void 0:null===(i=a.querySelector("title"))||void 0===i?void 0:i.innerHTML;return{artist:$(l),title:$(s)}}},I=t=>{var e;let{host:i}=new URL(t),[,n,r]=i.split(".");return null===(e=k[`${n}.${r}`])||void 0===e?void 0:e.call(k,t)}},918:function(t,e,i){i.d(e,{BS:function(){return a},FC:function(){return r},F_:function(){return n},wV:function(){return o}});let n={bottom:!1,bottomLeft:!1,bottomRight:!1,left:!1,right:!1,top:!1,topLeft:!1,topRight:!1},r={bottom:!0,bottomLeft:!0,bottomRight:!0,left:!0,right:!0,top:!0,topLeft:!0,topRight:!0},o=30,a=166,l={cancel:".cancel",dragHandleClassName:"handle",enableUserSelectHack:!1,minHeight:`${o}px`,minWidth:`${a}px`,resizeHandleStyles:{bottom:{bottom:"-3px",cursor:"ns-resize",height:"6px"},bottomLeft:{bottom:"-3px",cursor:"nesw-resize",height:"12px",left:"-3px",width:"12px"},bottomRight:{bottom:"-3px",cursor:"nwse-resize",height:"12px",right:"-3px",width:"12px"},left:{cursor:"ew-resize",left:"-3px",width:"6px"},right:{cursor:"ew-resize",right:"-3px",width:"6px"},top:{cursor:"ns-resize",height:"6px",top:"-3px"},topLeft:{cursor:"nwse-resize",height:"12px",left:"-3px",top:"-3px",width:"12px"},topRight:{cursor:"nesw-resize",height:"12px",right:"-3px",top:"-3px",width:"12px"}}};e.ZP=l},38365:function(t,e,i){i.d(e,{Rf:function(){return l},b$:function(){return d},hu:function(){return a},ix:function(){return u},mZ:function(){return s}});var n=i(918),r=i(97836),o=i(6484);let a=(t,e,i=[],n=0)=>{let[a]=t.split(r.CC),l=`${a}${r.CC}`,s=i.find(t=>t.startsWith(l))||"",{componentWindow:u}=(null==e?void 0:e[s])||{},{x:d=0,y:h=0,width:p=0,height:c=0}=(null==u?void 0:u.getBoundingClientRect())||{};return!(d+n+p>(0,o.E9)()||h+n+c>(0,o.sI)())&&(d||h)?{x:d+n,y:h+n}:void 0},l=({height:t,width:e})=>{let[i,n]=[(0,o.sI)(),(0,o.E9)()];return{x:Math.floor(n/2-(0,o.Vy)(e)/2),y:Math.floor((i-r.bK)/2-(0,o.Vy)(t)/2)}},s={BOTTOM:15,LEFT:150,RIGHT:50,TOP:15},u=(t,e,i=!1)=>{let{position:n,size:r}=t||{},{x:a=0,y:l=0}=n||{},{height:u=0,width:d=0}=r||{};return i?a+s.RIGHT>e.x||a+(0,o.Vy)(d)-s.LEFT<0||l+s.BOTTOM>e.y||l+s.TOP<0:a<0||l<0||a+(0,o.Vy)(d)>e.x||l+(0,o.Vy)(u)>e.y},d=(t,e)=>{let i=Number(t.height),a=Number(t.width),[l,s]=[(0,o.sI)(),(0,o.E9)()],u=l-r.bK,d=Math.max(n.wV,Math.min(i,u)),h=Math.max(n.BS,Math.min(a,s));if(!e)return{height:d,width:h};let p=i===d,c=a===h;return p||c?p?c?{height:d,width:h}:{height:Math.round(d/(a/h)),width:h}:{height:d,width:Math.round(h/(i/d))}:i>a?{height:d,width:Math.round(h/(u/d))}:{height:Math.round(d/(s/h)),width:h}}}}]);